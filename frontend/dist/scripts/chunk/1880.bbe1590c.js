"use strict";(self.webpackChunktestAmis=self.webpackChunktestAmis||[]).push([[1880],{61880:function(e,t,n){n.r(t),n.d(t,{TableRenderer:function(){return k},default:function(){return R}});var r=n(31635),o=n(96540),a=n(40961),i=n(22451),l=n(50346),s=n(88055),d=n.n(s),c=n(2404),u=n.n(c),p=n(5287),m=n.n(p),h=n(8096),v=n(65408),y=n(36607),f=function(e){function t(t){var n=e.call(this,t)||this;return n.formItems=[],n.handleSubmit=n.handleSubmit.bind(n),n.handleAction=n.handleAction.bind(n),n}return(0,r.C6)(t,e),t.prototype.buildSchema=function(){var e,t,n,o,a,i,l,s=this.props,d=s.searchable,c=s.sortable,u=s.name,p=s.label,m=s.translate,h=s.testIdBuilder;if(!0===d?l={title:"",controls:[{type:"text",name:u,placeholder:p,clearable:!0,testid:null===(e=null==h?void 0:h.getChild(u))||void 0===e?void 0:e.getTestIdValue()}]}:d&&(l=d.controls||d.tabs||d.fieldSet?(0,r.Cl)((0,r.Cl)({title:""},d),{controls:Array.isArray(d.controls)?d.controls.concat():void 0}):"form"===(null==d?void 0:d.type)?d:{title:"",className:d.formClassName,controls:[(0,r.Cl)({type:d.type||"text",name:d.name||u,testid:null===(t=null==h?void 0:h.getChild(d.name||u))||void 0===t?void 0:t.getTestIdValue(),placeholder:p},d)]}),l&&l.controls&&c&&l.controls.unshift({type:"hidden",name:"orderBy",value:u},{type:"button-group",name:"order",label:m("sort"),options:[{label:m("asc"),value:"asc"},{label:m("desc"),value:"desc"}]}),l){var v=[];(l.controls||l.body||[]).forEach((function(e){return e.name&&"orderBy"!==e.name&&"order"!==e.name&&v.push(e.name)})),this.formItems=v,l=(0,r.Cl)((0,r.Cl)({},l),{type:"form",wrapperComponent:"div",wrapWithPanel:!0,title:!1,testid:null===(n=null==h?void 0:h.getChild("form"))||void 0===n?void 0:n.getTestIdValue(),actions:[{type:"button",label:m("reset"),actionType:"clear-and-submit",testid:null===(o=null==h?void 0:h.getChild("btn-reset"))||void 0===o?void 0:o.getTestIdValue()},{type:"button",label:m("cancel"),actionType:"cancel",testid:null===(a=null==h?void 0:h.getChild("btn-cancel"))||void 0===a?void 0:a.getTestIdValue()},{label:m("search"),type:"submit",primary:!0,testid:null===(i=null==h?void 0:h.getChild("btn-search"))||void 0===i?void 0:i.getTestIdValue()}]})}return l||"error"},t.prototype.handleAction=function(e,t,n,o){return(0,r.sH)(this,void 0,void 0,(function(){var a,i,l,s,d,c,u;return(0,r.YH)(this,(function(p){switch(p.label){case 0:return a=this.props,i=a.onAction,l=a.data,s=a.dispatchEvent,d=a.name,"cancel"===t.actionType||"close"===t.actionType?(o(),[2]):"reset"===t.actionType?(o(),this.handleReset(),[2]):(c=(0,r.Cl)({},l),this.formItems.forEach((function(e){return(0,h.BBb)(c,e,void 0)})),[4,s("columnSearch",(0,h.ed2)(l,{searchName:d,searchValue:c}))]);case 1:return(null==(u=p.sent())?void 0:u.prevented)||i&&i(e,t,n),[2]}}))}))},t.prototype.handleReset=function(){return(0,r.sH)(this,void 0,void 0,(function(){var e,t,n,o,a;return(0,r.YH)(this,(function(i){switch(i.label){case 0:return e=this.props,t=e.onSearch,n=e.data,o=e.name,a=(0,r.Cl)({},n),this.formItems.forEach((function(e){return(0,h.BBb)(a,e,void 0)})),a.orderBy===o&&(a.orderBy="",a.order="asc"),t?[4,t(o,a)]:[3,2];case 1:i.sent(),i.label=2;case 2:return t&&t(a),[2]}}))}))},t.prototype.handleSubmit=function(e,t){return(0,r.sH)(this,void 0,void 0,(function(){var n,o,a;return(0,r.YH)(this,(function(i){switch(i.label){case 0:return n=this.props,o=n.onSearch,a=n.name,e.order&&(e=(0,r.Cl)((0,r.Cl)({},e),{orderBy:a})),o?[4,o(a,e)]:[3,2];case 1:i.sent(),i.label=2;case 2:return t(),[2]}}))}))},t.prototype.isActive=function(){var e=this.props,t=e.data,n=e.name,r=e.orderBy;return r&&r===n||this.formItems.some((function(e){return null==t?void 0:t[e]}))},t.prototype.render=function(){var e=this,t=this.props,n=t.render,i=t.name,l=t.data,s=t.searchable,d=t.order,c=t.orderBy,u=t.popOverContainer,p=t.classPrefix,m=t.classnames,h=t.testIdBuilder,y=this.buildSchema(),f=this.isActive();return o.createElement(v.EQ,{className:"".concat(p,"TableCell-searchBtn"),layerClassName:m("".concat(p,"TableCell-searchPopOver"),s.className),active:f,filterIcon:o.createElement(v.In,{icon:"search",className:"icon",iconContent:"table-search-icon",testIdBuilder:null==h?void 0:h.getChild("search-icon")}),popOverContainer:u||function(){return(0,a.findDOMNode)(e)},filterDropdown:function(t){t.setSelectedKeys,t.selectedKeys;var o=t.confirm;return t.clearFilters,n("quick-search-form",y,{data:(0,r.Cl)((0,r.Cl)({},l),{orderBy:c,order:c&&c===i?d:""}),onSubmit:function(t){return e.handleSubmit(t,o)},onAction:function(t,n,r){e.handleAction(t,n,r,o)}})},testIdBuilder:h})},t}(o.Component),g=(0,y.PA)((function(e){var t=e.store;return o.createElement(f,(0,r.Cl)({},e,{data:t.query,orderBy:t.orderBy,order:t.order}))})),b=(n(58899),n(21199)),S=n(24123),C=n(63957),w=n(35151);!function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propsNeedRemove=["title"],t}(0,r.C6)(t,e),t.defaultProps=(0,r.Cl)((0,r.Cl)({},w.n.defaultProps),{wrapperComponent:"div"}),t=(0,r.Cg)([(0,h.A49)({type:"cell-field",name:"cell-field"}),(0,C.y)(),(0,S.c)(),(0,b.EX)()],t)}(w.n);var x=n(75935);!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,r.C6)(t,e),t.prototype.render=function(){var e=this.props;e.className,e.store;var t=e.render,n=e.classPrefix,a=e.classnames,i=e.tooltip,l=e.align,s=e.cols,d=e.toggleAllColumns,c=e.toggleToggle,u=e.data,p=e.size,m=e.popOverContainer,y=(0,r.Tt)(e,["className","store","render","classPrefix","classnames","tooltip","align","cols","toggleAllColumns","toggleToggle","data","size","popOverContainer"]),f=y.translate,g=y.env;if(!s)return null;var b=s.filter((function(e){return(0,h.zNq)(e.pristine||e,u)&&!1!==e.toggable})),S=b.filter((function(e){return!1!==e.toggled}));return o.createElement(x.A,(0,r.Cl)({},y,{render:t,tooltip:i||f("Table.columnsVisibility"),tooltipContainer:m||g.getModalContainer,isActived:-1!==s.findIndex((function(e){return!e.toggled})),align:null!=l?l:"right",size:p||"sm",classnames:a,classPrefix:n,key:"columns-toggable",columns:s,activeToggaleColumns:S,data:u}),(null==b?void 0:b.length)?o.createElement("li",{className:a("ColumnToggler-menuItem"),key:"selectAll",onClick:function(){d&&d((null==S?void 0:S.length)<=0)}},o.createElement(v.Sc,{size:"sm",classPrefix:n,key:"checkall",checked:!!(null==S?void 0:S.length),partial:!(!(null==S?void 0:S.length)||(null==S?void 0:S.length)===(null==b?void 0:b.length))},f("Checkboxes.selectAll"))):null,null==b?void 0:b.map((function(e,r){return o.createElement("li",{className:a("ColumnToggler-menuItem"),key:"item"+(e.index||r),onClick:function(){c&&c(r)}},o.createElement(v.Sc,{size:"sm",classPrefix:n,checked:!1!==e.toggled},e.title?t("tpl",e.title):e.label||null))})))},t=(0,r.Cg)([(0,h.A49)({type:"column-toggler",name:"column-toggler"})],t)}(o.Component);var R=function(e){function t(n,r){var o=e.call(this,n)||this;o.renderedToolbars=[],o.subForms={},o.columns=[],o.reactions=[],r.registerComponent(o);var a=n.store,l=n.columnsTogglable,s=n.columns,d=n.rowSelection,c=n.keyField,u=n.primaryField,p=n.canAccessSuperData;return a.update({columnsTogglable:l,columns:s,canAccessSuperData:p,rowSelectionKeyField:u||(null==d?void 0:d.keyField)||c}),t.syncRows(a,n,void 0)&&o.syncSelected(),o.columns=o.buildColumns(a.filteredColumns,[],[]),o.rowSelection=o.buildRowSelection(),o.expandable=o.buildExpandable(),o.reactions.push((0,i.mJ)((function(){return a.currentSelectedRowKeys.join(",")}),(function(){o.rowSelection=o.buildRowSelection(),o.forceUpdate()}))),o.reactions.push((0,i.mJ)((function(){return a.currentExpandedKeys.join(",")}),(function(){o.expandable=o.buildExpandable(),o.forceUpdate()}))),o.reactions.push((0,i.mJ)((function(){return a.filteredColumns}),(function(){o.columns=o.buildColumns(a.filteredColumns,[],[]),o.forceUpdate()}))),o}return(0,r.C6)(t,e),t.prototype.componentWillUnmount=function(){this.context.unRegisterComponent(this),this.reactions&&this.reactions.forEach((function(e){return e()}))},t.prototype.syncSelected=function(){var e=this.props,t=e.store,n=e.onSelect;n&&n(t.selectedRows.map((function(e){return e.data})),t.unSelectedRows.map((function(e){return e.data})))},t.syncRows=function(e,t,n){var o,a=t.source,i=(0,h.$_G)(t,(function(e){return e.items})),l=[],s=!1;if(!Array.isArray(i)||n&&(0,h.$_G)(n,(function(e){return e.items}))===i){if("string"==typeof a){var d=(0,h.GvO)(a,t.data,"| raw"),c=n?(0,h.GvO)(a,n.data,"| raw"):null;c&&c===d?s=!1:Array.isArray(d)&&(s=!0,l=d)}}else s=!0,l=i;s&&e.initRows(l,t.getEntryId,t.reUseRow,t.childrenColumnName);var u=[],p=e.keyField;Array.isArray(t.selected)?u=t.selected.map((function(e){return e[p]}))||[]:t.rowSelection&&t.rowSelection.selectedRowKeysExpr?l.forEach((function(e,n){var r;(0,h.pgu)((null===(r=t.rowSelection)||void 0===r?void 0:r.selectedRowKeysExpr)||"",{record:e,rowIndex:n})&&u.push(e[p])})):t.rowSelection&&t.rowSelection.selectedRowKeys&&(u=(0,r.fX)([],(0,r.zs)(t.rowSelection.selectedRowKeys),!1)),s&&u.length>0&&e.updateSelected(u);var m=[],v=t.primaryField||(null===(o=t.expandable)||void 0===o?void 0:o.keyField)||t.keyField;return t.expandable&&t.expandable.expandedRowKeysExpr?l.forEach((function(e,n){var r;(0,h.pgu)((null===(r=t.expandable)||void 0===r?void 0:r.expandedRowKeysExpr)||"",{record:e,rowIndex:n})&&m.push(e[v])})):t.expandable&&t.expandable.expandedRowKeys&&(m=(0,r.fX)([],(0,r.zs)(t.expandable.expandedRowKeys),!1)),s&&m.length>0&&e.updateExpanded(m,v),s},t.prototype.componentDidUpdate=function(e){var n,r,o,a=this.props,i=a.store;if((0,h.MwK)(["orderBy","columnsTogglable","canAccessSuperData"],e,a,(function(e){e.orderBy&&!a.onQuery&&delete e.orderBy,i.update(e,{resolveDefinitions:a.resolveDefinitions})})),(0,h.TIf)(["source","value","items"],e,a)||!a.value&&!a.items&&(a.data!==e.data||"string"==typeof a.source&&(0,h.joH)(a.source)))t.syncRows(i,a,e)&&this.syncSelected();else if((0,h.Kbh)(e.selected,a.selected)){var l=i.keyField,s=i.selectedRows.map((function(e){return e[l]})).join(",");i.updateSelected(a.selected.map((function(e){return e[l]}))||[]),s!==i.selectedRows.map((function(e){return e[l]})).join(",")&&this.syncSelected()}(0,h.TIf)(["columns"],e,a)&&i.update({columns:a.columns}),(0,h.TIf)(["rowSelection","selectable","multiple","maxKeepItemSelectionLength"],e,a)&&(this.rowSelection=this.buildRowSelection()),(0,h.TIf)(["query","pageField","perPageField"],e,a)&&i.updateQuery(a.query,void 0,a.pageField,a.perPageField,!0),u()(null===(n=null==e?void 0:e.rowSelection)||void 0===n?void 0:n.keyField,null===(r=a.rowSelection)||void 0===r?void 0:r.keyField)&&u()(e.keyField,a.keyField)||i.update({rowSelectionKeyField:a.primaryField||(null===(o=a.rowSelection)||void 0===o?void 0:o.keyField)||a.keyField})},t.prototype.getPopOverContainer=function(){return(0,a.findDOMNode)(this)},t.prototype.subFormRef=function(e,t,n){var r=this.props.quickEditFormRef;r&&r(e,t,n),this.subForms["".concat(t,"-").concat(n)]=e,e&&this.props.store.addForm(e.props.store,n)},t.prototype.reset=function(){var e=this;this.props.store.reset();var t=[];Object.keys(this.subForms).forEach((function(n){return e.subForms[n]&&t.push(e.subForms[n])})),t.forEach((function(e){return e.clearErrors()}))},t.prototype.renderCellSchema=function(e,t){var n=this.props,o=n.render;if(n.store,e&&(0,h.Gvm)(e)){e.width,e.children;var a=e.title,i=(0,r.Tt)(e,["width","children","title"]);return o("cell-field",(0,r.Cl)((0,r.Cl)({},i),{title:a||i.label,type:"cell-field",column:i,data:t.data,name:e.name}),t)}return e},t.prototype.renderSchema=function(e,t,n){var o=this.props.render;if(t&&(0,h.Gvm)(t))return o(e||"field",(0,r.Cl)((0,r.Cl)({},t),{data:null==n?void 0:n.data}),n);if(Array.isArray(t)){var a=[];return t.forEach((function(t,i){return a.push(o(e||"field",(0,r.Cl)((0,r.Cl)({},t),{data:null==n?void 0:n.data}),(0,r.Cl)((0,r.Cl)({},n),{key:i})))})),a}return"string"==typeof t?(0,h.pbD)(t,null==n?void 0:n.data):t},t.prototype.buildColumns=function(e,t,n){var a=this,i=this.props,l=i.render,s=i.store,c=i.popOverContainer,u=(i.canAccessSuperData,i.showBadge),p=i.itemBadge,m=i.data,v=i.classnames,y=i.env,f=i.testIdBuilder,b=[];return Array.isArray(e)&&e.forEach((function(e,i){return(0,r.sH)(a,void 0,void 0,(function(){var a,S,C,w,x,R,k,E,A,F,I,N=this;return(0,r.YH)(this,(function(O){switch(O.label){case 0:return a=(0,r.Cl)({},e),S=null,C={popOverContainer:c||this.getPopOverContainer,value:e.title||e.label},(0,h.Gvm)(e.title)?S=d()(e.title):"string"!=typeof e.title&&"string"!=typeof e.label||(S={type:"plain"}),e.align&&(S.align=e.align,S.className="flex-1"),w=function(t){var n,r=N.renderCellSchema(S,C),a=null;return e.remark&&(a=l("remark",{type:"remark",tooltip:e.remark,container:N.getPopOverContainer})),o.createElement("div",{key:i,className:v("Table-head-cell-wrapper",(n={},n["".concat(e.className)]=!!e.className,n["".concat(e.titleClassName)]=!!e.titleClassName,n)),style:{justifyContent:{right:"flex-end",center:"center"}[e.align]||"flex-start"}},r,a,t)},Object.assign(a,{title:w}),x=!!(null===(I=e.children)||void 0===I?void 0:I.length),e.canAccessSuperData,e.type&&Object.assign(a,{render:function(o,a,l,d,m){var v=s.getRowByIndex(l,(0,r.fX)([],(0,r.zs)(m||[]),!1))||{},y=null==f?void 0:f.getChild("row-".concat(l,"-cell-").concat(d)),g={children:N.renderCellSchema(e,{data:v.locals,btnDisabled:s.dragging,popOverContainer:c||N.getPopOverContainer,quickEditFormRef:N.subFormRef,onQuickChange:function(e,t,n,r){N.handleQuickChange(v,e,t,n,r)},row:v,showBadge:u&&0===i,itemBadge:p,testIdBuilder:y}),props:{}};if(!x&&e.rowSpanExpr){var b=+(0,h.pbD)(e.rowSpanExpr,{record:a,rowIndex:l,colIndex:d});b&&(g.props.rowSpan=b,t.push({colIndex:d,rowIndex:l,rowSpan:b}))}if(!x&&e.colSpanExpr){var S=+(0,h.pbD)(e.colSpanExpr,{record:a,rowIndex:l,colIndex:d});S&&(g.props.colSpan=S,n.push({colIndex:d,rowIndex:l,colSpan:S}))}return t.forEach((function(e){d===e.colIndex&&l>e.rowIndex&&l<e.rowIndex+(e.rowSpan||0)&&(g.props.rowSpan=0)})),n.forEach((function(e){l===e.rowIndex&&d>e.colIndex&&d<e.colIndex+(e.colSpan||0)&&(g.props.colSpan=0)})),g}}),e.searchable&&(a.filterDropdown=o.createElement(g,(0,r.Cl)({},this.props,{popOverContainer:this.getPopOverContainer,name:e.name,searchable:e.searchable,onSearch:this.handleSearch,key:"th-search-"+i,testIdBuilder:null==f?void 0:f.getChild("head-search-".concat(i))}))),e.sortable&&(a.sorter=!0),e.filterable?e.filterable.options?(a.filters=e.filterable.options.map((function(e){return"string"==typeof e?{text:e,value:e}:{text:e.label,value:e.value}})),[3,4]):[3,1]:[3,4];case 1:return e.filterable.source?(R=e.filterable.source,(0,h.joH)(R)?(k=(0,h.GvO)(R,m,"| raw"),a.filters=k,[3,4]):[3,2]):[3,4];case 2:return(0,h.Amo)(R,m)?((E=(0,h.UfW)(R)).cache=3e3,[4,y.fetcher(E,m)]):[3,4];case 3:A=O.sent(),F=A.data&&A.data.options||[],a.filters=F,O.label=4;case 4:return x&&(a.children=this.buildColumns(e.children,t,n)),b.push(a),[2]}}))}))})),b},t.prototype.buildSummary=function(e,t){var n=this,r=[];return Array.isArray(t)&&t.forEach((function(t,o){(0,h.Gvm)(t)?r.push({colSpan:t.colSpan,fixed:t.fixed,cellClassName:t.cellClassName,render:function(r){return n.renderSchema(e,t,{data:r})}}):Array.isArray(t)&&(r[o]||r.push([]),t.forEach((function(t){r[o].push({colSpan:t.colSpan,fixed:t.fixed,cellClassName:t.cellClassName,render:function(r){return n.renderSchema(e,t,{data:r})}})})))})),r.length?r:null},t.prototype.rowClassName=function(e,t){var n=this.props,o=n.rowClassNameExpr,a=n.store,i=n.themeCss,l=n.id,s=n.rowClassName,d=[];s&&d.push(s),o&&d.push((0,h.pbD)(o,{record:e,rowIndex:t}));var c=a.getRowByIndex(t);return(null==c?void 0:c.modified)&&d.push("is-modified"),(null==c?void 0:c.moved)&&d.push("is-moved"),d.push((0,h.NH8)((0,r.Cl)((0,r.Cl)({},this.props),{name:"tableRowClassname",id:l,themeCss:i}))),d.join(" ")},t.prototype.buildRowSelection=function(){var e=this,t=this.props,n=t.selectable,o=t.multiple,a=t.maxKeepItemSelectionLength,i=t.rowSelection,l=t.store,s=null;if(n)s={type:!1===o?"radio":"",selectedRowKeys:l.currentSelectedRowKeys,maxSelectedLength:a};else if(i){i.selectedRowKeys;var d=i.selections,c=(0,r.Tt)(i,["selectedRowKeys","selections"]);(s=(0,r.Cl)({selectedRowKeys:l.currentSelectedRowKeys,maxSelectedLength:a},c)).getCheckboxProps=function(t,n){var r=e.props,o=r.rowSelection,a=r.maxKeepItemSelectionLength,i=r.store,l=null==o?void 0:o.disableOn;return{disabled:!!l&&(0,h.pgu)(l,{record:t,rowIndex:n})||a&&i.currentSelectedRowKeys.length>=a&&!i.currentSelectedRowKeys.includes(t[i.keyField])}},i.disableOn&&delete s.disableOn,d&&Array.isArray(d)&&(s.selections=[],d.forEach((function(e){s.selections.push({key:e.key,text:e.text,onSelect:function(t){var n;n=t.filter((function(t,n){return"all"===e.key||"none"!==e.key&&("invert"===e.key?!l.currentSelectedRowKeys.includes(t):"odd"===e.key?n%2==0:"even"!==e.key||n%2!=0)})),l.updateSelected(n)}})})))}return s},t.prototype.expandedRowClassName=function(e,t){var n=this.props.expandable;return(0,h.pbD)(null==n?void 0:n.expandedRowClassNameExpr,{record:e,rowIndex:t})},t.prototype.expandedRowRender=function(e,t){var n=this.props.expandable;return this.renderSchema("expandableBody",(0,r.Cl)({},n),{data:(0,r.Cl)((0,r.Cl)({},this.props.data),{record:e,rowIndex:t})})},t.prototype.rowExpandable=function(e,t,n){var r=this.props.expandable;return!!(null==r?void 0:r.expandableOn)&&(0,h.pgu)(r.expandableOn,{record:e,rowIndex:t})},t.prototype.buildExpandable=function(){var e=this.props,t=e.expandable,n=e.store,o=null;if(t){t.expandedRowKeys;var a=(0,r.Tt)(t,["expandedRowKeys"]);o=(0,r.Cl)({expandedRowKeys:n.currentExpandedKeys},a),t.expandableOn&&(o.rowExpandable=this.rowExpandable,delete o.expandableOn),t&&t.type&&(o.expandedRowRender=this.expandedRowRender),t.expandedRowClassNameExpr&&(o.expandedRowClassName=this.expandedRowClassName,delete o.expandedRowClassNameExpr)}return o},t.prototype.reloadTarget=function(e,t){this.context.reload(e,t)},t.prototype.handleSave=function(){return(0,r.sH)(this,void 0,void 0,(function(){var e,t,n,o,a,i,l,s,d,c,u=this;return(0,r.YH)(this,(function(r){switch(r.label){case 0:return e=this.props,t=e.store,n=e.onSave,o=e.primaryField,a=e.keyField,t.modifiedRows.length?(i=[],Object.keys(this.subForms).forEach((function(e){return u.subForms[e]&&i.push(u.subForms[e])})),i.length?[4,Promise.all(i.map((function(e){return e.validate()})))]:[3,2]):[2];case 1:if(~r.sent().indexOf(!1))return[2];r.label=2;case 2:return l=t.modifiedRows.map((function(e){return e.data})),s=t.modifiedRows.map((function(e){return e.path})),d=t.modifiedRows.map((function(e){return(0,h.iv2)(e.data,e.pristine,[a,o])})),c=t.rows.filter((function(e){return!e.modified})).map((function(e){return e.data})),n?(n(l,d,s,c,t.modifiedRows.map((function(e){return e.pristine}))),[2]):(this.handleQuickSave(l,d,s,c,t.modifiedRows.map((function(e){return e.pristine}))),[2])}}))}))},t.prototype.handleQuickSave=function(e,t,n,r,o,a){var i=this,l=this.props,s=l.store,d=l.quickSaveApi,c=l.quickSaveItemApi,u=l.primaryField,p=l.keyField,m=l.env,v=l.messages,y=l.reload,f=l.dispatchEvent;if(Array.isArray(e)){if(!(0,h.Amo)(d))return void(m&&m.alert("Table2 quickSaveApi is required"));var g=u||p,b=(0,h.ed2)(s.data,{rows:e,rowsDiff:t,indexes:n,rowsOrigin:o});e.length&&e[0].hasOwnProperty(g)&&(b.ids=e.map((function(e){return e[g]})).join(",")),r&&(b.unModifiedItems=r),s.saveRemote(d,b,{successMessage:v&&v.saveFailed,errorMessage:v&&v.saveSuccess}).then((function(){f("quickSaveSubmitted",b),y&&i.reloadTarget((0,h.Wvn)(y,b),b)})).catch((function(){}))}else{if(!(0,h.Amo)(c))return void(m&&m.alert("Table2 quickSaveItemApi is required!"));var S=(0,h.ed2)(s.data,{item:e,modified:t,origin:o}),C=(0,h.ed2)(S,e);s.saveRemote(c,C).then((function(){f("quickSaveSubmitted",C),y&&i.reloadTarget((0,h.Wvn)(y,S),S)})).catch((function(){(null==a?void 0:a.resetOnFailed)&&i.reset()}))}},t.prototype.handleQuickChange=function(e,t,n,r,o){if((0,l._n)(e)){var a=this.props,i=a.onSave,s=a.onPristineChange,d=a.saveImmediately,c=a.primaryField,u=a.keyField,p=a.quickSaveItemApi;e.change(t,r),e.modified&&this.syncSelected(),r?null==s||s(e.data,e.path):(n||d)&&(n&&n.api?this.props.onAction&&this.props.onAction(null,{actionType:"ajax",api:n.api,reload:null==o?void 0:o.reload},e.locals):i?i(e.data,(0,h.iv2)(e.data,e.pristine,[u,c]),e.path,void 0,e.pristine,o):this.handleQuickSave(p?e.data:[e.data],(0,h.iv2)(e.data,e.pristine,[u,c]),[e.path],void 0,e.pristine,o))}},t.prototype.handleAction=function(e,t,n){var r=this.props.onAction;r&&r(e,t,n)},t.prototype.renderActions=function(e){var t=this,n=this.props,a=n.actions,i=n.render,l=n.store,s=n.classnames,d=n.data,c=n.columnsTogglable,u=n.dispatchEvent;a=Array.isArray(a)?a.concat():[];var p=(0,h.Gvm)(c)?c:{};return l.toggable&&"header"===e&&!~this.renderedToolbars.indexOf("columns-toggler")&&a.push({type:"button",children:i("column-toggler",(0,r.Cl)((0,r.Cl)({},p),{type:"column-toggler"}),{cols:l.columnsData,toggleAllColumns:function(){l.toggleAllColumns(),u("columnToggled",(0,h.ed2)(d,{columns:l.columnsData.filter((function(e){return e.toggled}))}))},toggleToggle:function(e){l.columnsData[e].toggleToggle(),u("columnToggled",(0,h.ed2)(d,{columns:l.columnsData.filter((function(e){return e.toggled}))}))}})}),Array.isArray(a)&&a.length?o.createElement("div",{className:s("Table-toolbar")},a.map((function(e,n){return i("action/".concat(n),(0,r.Cl)({type:"button"},e),{onAction:t.handleAction,key:n,btnDisabled:l.dragging,data:l.getData(d)})}))):null},t.prototype.handleSelected=function(e,t,n){return(0,r.sH)(this,void 0,void 0,(function(){var o,a,i,l,s;return(0,r.YH)(this,(function(r){switch(r.label){case 0:return o=this.props,a=o.dispatchEvent,i=o.data,l=o.store,[4,a("selectedChange",(0,h.ed2)(i,{selectedItems:e,unSelectedItems:n}))];case 1:return(null==(s=r.sent())?void 0:s.prevented)?[2,null==s?void 0:s.prevented]:(l.updateSelected(t),this.syncSelected(),[2])}}))}))},t.prototype.handleSort=function(e){return(0,r.sH)(this,void 0,void 0,(function(){var t,n,o,a,i;return(0,r.YH)(this,(function(r){switch(r.label){case 0:return t=this.props,n=t.dispatchEvent,o=t.data,a=t.onSort,[4,n("columnSort",(0,h.ed2)(o,{orderBy:e.orderBy,orderDir:e.orderDir}))];case 1:return(null==(i=r.sent())?void 0:i.prevented)?[2,null==i?void 0:i.prevented]:(a&&a(e),[2])}}))}))},t.prototype.handleFilter=function(e){return(0,r.sH)(this,void 0,void 0,(function(){var t,n,o,a,i;return(0,r.YH)(this,(function(r){switch(r.label){case 0:return t=this.props,n=t.dispatchEvent,o=t.data,a=t.onSearch,[4,n("columnFilter",(0,h.ed2)(o,e))];case 1:return(null==(i=r.sent())?void 0:i.prevented)?[2,null==i?void 0:i.prevented]:(a&&a(e),[2])}}))}))},t.prototype.handleSearch=function(e,t){return(0,r.sH)(this,void 0,void 0,(function(){var n,o,a,i,l,s,d;return(0,r.YH)(this,(function(r){switch(r.label){case 0:return n=this.props,o=n.data,a=n.dispatchEvent,i=n.store,l=n.onSearch,[4,a("columnSearch",(0,h.ed2)(o,{searchName:e,searchValue:t}))];case 1:return(null==(s=r.sent())?void 0:s.prevented)||(i.updateQuery(t),l&&l(((d={})[e]=t[e],d))),[2]}}))}))},t.prototype.handleRowClick=function(e,t,n){return(0,r.sH)(this,void 0,void 0,(function(){var o,a,i,l,s;return(0,r.YH)(this,(function(r){switch(r.label){case 0:return o=this.props,a=o.dispatchEvent,i=o.data,l=o.onRow,[4,a("rowClick",(0,h.ed2)(i,{item:t,index:n}))];case 1:return(null==(s=r.sent())?void 0:s.prevented)||t&&l&&l.onRowClick&&l.onRowClick(e,t,n),[2]}}))}))},t.prototype.handleRowDbClick=function(e,t,n){return(0,r.sH)(this,void 0,void 0,(function(){var o,a,i,l,s;return(0,r.YH)(this,(function(r){switch(r.label){case 0:return o=this.props,a=o.dispatchEvent,i=o.data,l=o.onRow,[4,a("rowDbClick",(0,h.ed2)(i,{item:t,index:n}))];case 1:return(null==(s=r.sent())?void 0:s.prevented)?[2,!1]:(t&&l&&l.onRowDbClick&&l.onRowDbClick(e,t,n),[2,!0])}}))}))},t.prototype.handleRowMouseEnter=function(e,t,n){var o;return(0,r.sH)(this,void 0,void 0,(function(){var a,i,l,s,d;return(0,r.YH)(this,(function(r){switch(r.label){case 0:return null===(o=null==e?void 0:e.persist)||void 0===o||o.call(e),a=this.props,i=a.dispatchEvent,l=a.data,s=a.onRow,[4,i("rowMouseEnter",(0,h.ed2)(l,{item:t,index:n}))];case 1:return(null==(d=r.sent())?void 0:d.prevented)||t&&s&&s.onRowMouseEnter&&s.onRowMouseEnter(e,t,n),[2]}}))}))},t.prototype.handleRowMouseLeave=function(e,t,n){var o;return(0,r.sH)(this,void 0,void 0,(function(){var a,i,l,s,d;return(0,r.YH)(this,(function(r){switch(r.label){case 0:return null===(o=null==e?void 0:e.persist)||void 0===o||o.call(e),a=this.props,i=a.dispatchEvent,l=a.data,s=a.onRow,[4,i("rowMouseLeave",(0,h.ed2)(l,{item:t,index:n}))];case 1:return(null==(d=r.sent())?void 0:d.prevented)||t&&s&&s.onRowMouseLeave&&s.onRowMouseLeave(e,t,n),[2]}}))}))},t.prototype.handleOrderChange=function(e,t,n){return(0,r.sH)(this,void 0,void 0,(function(){var o,a;return(0,r.YH)(this,(function(r){return o=this.props.store,a=o.getRowByIndex(e,n),o.exchange(e,t,a),[2]}))}))},t.prototype.handleSaveOrder=function(){return(0,r.sH)(this,void 0,void 0,(function(){var e,t,n,o,a,i,l,s;return(0,r.YH)(this,(function(r){switch(r.label){case 0:return e=this.props,t=e.store,n=e.onSaveOrder,o=e.data,a=e.dispatchEvent,i=t.movedRows.map((function(e){return e.data})),l=t.rows.map((function(e){return e.getDataWithModifiedChilden()})),[4,a("orderChange",(0,h.ed2)(o,{movedItems:i}))];case 1:return(null==(s=r.sent())?void 0:s.prevented)?[2]:n&&t.movedRows.length?(n(i,l),[2]):[2]}}))}))},t.prototype.doAction=function(e,t,n,r){var o=this,a=this.props,i=a.store,l=a.data,s=a.keyField,d=a.expandable,c=a.primaryField,u=null==e?void 0:e.actionType,p=i.keyField,m=i.getData(l).items||[];switch(u){case"selectAll":i.updateSelectedAll();break;case"clearAll":i.updateSelected([]);break;case"select":var v=[];m.forEach((function(e,t){(0,h.pgu)((null==r?void 0:r.selected)||(null==r?void 0:r.selectedRowKeysExpr),{record:e,rowIndex:t})&&v.push(e[p])})),i.updateSelected(v);break;case"expand":var y=c||(null==d?void 0:d.keyField)||s,f=[],g=[];if(null==r?void 0:r.value){var b=m.findIndex((function(e){return e[y]===r.value})),S=m[b];this.tableRef&&this.tableRef.isExpandableRow(S,b)&&(this.tableRef.isExpanded(S)?g.push(S):f.push(S))}else(null==r?void 0:r.expandedRowsExpr)&&m.forEach((function(e,t){(0,h.pgu)(null==r?void 0:r.expandedRowsExpr,{record:e,rowIndex:t})&&o.tableRef&&o.tableRef.isExpandableRow(e,t)&&(o.tableRef.isExpanded(e)?g.push(e):f.push(e))}));f.length>0&&this.tableRef&&this.tableRef.onExpandRows(f),g.length>0&&this.tableRef&&this.tableRef.onCollapseRows(g);break;default:this.handleAction(void 0,e,l)}},t.prototype.getRef=function(e){this.tableRef=e},t.prototype.renderTable=function(){var e=this.props,t=e.render,n=e.title,a=e.footer;e.rowSelection,e.selectable,e.multiple,e.columns,e.expandable;var i=e.footSummary,l=e.headSummary,s=e.loading,d=e.classnames,c=e.placeholder;e.rowClassNameExpr;var u=e.itemActions,p=e.keyField,m=e.primaryField;e.maxKeepItemSelectionLength;var y=e.onRow,f=e.store,g=e.id,b=e.themeCss,S=(0,r.Tt)(e,["render","title","footer","rowSelection","selectable","multiple","columns","expandable","footSummary","headSummary","loading","classnames","placeholder","rowClassNameExpr","itemActions","keyField","primaryField","maxKeepItemSelectionLength","onRow","store","id","themeCss"]),C=void 0;if(u){var w=Array.isArray(u)?u.filter((function(e){return!e.hiddenOnHover})):[];if(!w.length)return null;C=function(e,n){return o.createElement("div",{className:d("Table-itemActions")},w.map((function(o,a){return t("itemAction/".concat(a),(0,r.Cl)((0,r.Cl)({},o),{isMenuItem:!0}),{key:a,item:e,data:e,rowIndex:n})})))}}var x={data:this.props.data};return o.createElement(v.XI,(0,r.Cl)({},S,{headerClassName:(0,h.NH8)((0,r.Cl)((0,r.Cl)({},this.props),{name:"tableHeadClassname",id:g,themeCss:b})),bodyClassname:(0,h.NH8)((0,r.Cl)((0,r.Cl)({},this.props),{name:"tableBodyClassname",id:g,themeCss:b})),onRef:this.getRef,title:this.renderSchema("title",n,x),footer:this.renderSchema("footer",a,x),columns:this.columns,dataSource:f.dataSource,rowSelection:this.rowSelection,rowClassName:this.rowClassName,expandable:this.expandable,footSummary:this.buildSummary("footSummary",i),headSummary:this.buildSummary("headSummary",l),loading:this.renderSchema("loading",s,x),placeholder:this.renderSchema("placeholder",c,x),onSelect:this.handleSelected,onSelectAll:this.handleSelected,onSort:this.handleSort,onFilter:this.handleFilter,onDrag:this.handleOrderChange,itemActions:C,keyField:m||p,onRow:(0,r.Cl)((0,r.Cl)({},y),{onRowClick:this.handleRowClick,onRowDbClick:this.handleRowDbClick,onRowMouseEnter:this.handleRowMouseEnter,onRowMouseLeave:this.handleRowMouseLeave})}))},t.prototype.renderHeading=function(){var e=this.props,t=e.store,n=e.hideQuickSaveBtn,r=e.classnames,a=e.headingClassName,i=e.saveImmediately,l=e.quickSaveApi,s=e.translate,d=e.columns,c=!1;if(1===t.modifiedRows.length){var u=(null==d?void 0:d.map((function(e){var t;return(null===(t=null==e?void 0:e.quickEdit)||void 0===t?void 0:t.saveImmediately)?null==e?void 0:e.name:""})).filter((function(e){return e})))||[],p=t.modifiedRows[0],y=(0,h.iv2)(p.data,p.pristine);m()(u,Object.keys(y)).length&&(c=!0)}return l&&!i&&!c&&t.modified&&!n||t.moved?o.createElement("div",{className:r("Table-heading",a),key:"heading"},i||!t.modified||n||c?t.moved?o.createElement("span",null,s("Table.moved",{moved:t.moved}),o.createElement("button",{type:"button",className:r("Button Button--size-xs Button--success m-l-sm"),onClick:this.handleSaveOrder},o.createElement(v.In,{icon:"check",className:"icon m-r-xs"}),s("Form.submit")),o.createElement("button",{type:"button",className:r("Button Button--size-xs Button--danger m-l-sm"),onClick:this.reset},o.createElement(v.In,{icon:"close",className:"icon m-r-xs"}),s("Table.discard"))):"":o.createElement("span",null,s("Table.modified",{modified:t.modified}),o.createElement("button",{type:"button",className:r("Button Button--size-xs Button--success m-l-sm"),onClick:this.handleSave},o.createElement(v.In,{icon:"check",className:"icon m-r-xs"}),s("Form.submit")),o.createElement("button",{type:"button",className:r("Button Button--size-xs Button--danger m-l-sm"),onClick:this.reset},o.createElement(v.In,{icon:"close",className:"icon m-r-xs"}),s("Table.discard")))):null},t.prototype.render=function(){var e=this.props,t=e.classnames,n=e.style,a=e.store,i=e.themeCss,l=e.wrapperCustomStyle,s=e.id,d=e.env;this.renderedToolbars=[];var c=this.renderHeading();return o.createElement("div",{className:t("Table-render-wrapper",(0,h.NH8)((0,r.Cl)((0,r.Cl)({},this.props),{name:"wrapperCustomStyle",id:s,themeCss:l})),{"Table--unsaved":!!a.modified||!!a.moved}),style:n},this.renderActions("header"),c,this.renderTable(),o.createElement(h.z4D,(0,r.Cl)({},this.props,{config:{themeCss:i,classNames:[{key:"tableHeadClassname",weights:{default:{inner:".".concat(t("Table-table")," > thead > tr > th"),important:!0}}},{key:"tableHeadClassname",weights:{default:{inner:"> tr > th",important:!0}}},{key:"tableBodyClassname",weights:{default:{inner:"> tbody.".concat(t("Table-tbody")," > tr  td")},hover:{suf:"> tbody > tr",inner:"td",important:!0}}},{key:"tableRowClassname",weights:{default:{parent:".".concat(t("Table-table")," > tbody.").concat(t("Table-tbody")),inner:"td.".concat(t("Table-cell"))},hover:{parent:".".concat(t("Table-table")," > tbody.").concat(t("Table-tbody")),inner:"td.".concat(t("Table-cell"))}}}],wrapperCustomStyle:l,id:s},env:d})))},t.contextType=h.MzX,t.propsList=["source","columnsTogglable","columns","items","rowSelection","expandable","sticky","itemBadge","popOverContainer","keyField","childrenColumnName","rowClassNameExpr","lineHeight","bordered","footer","maxKeepItemSelectionLength","keepItemSelectionOnPageChange","itemActions","headingClassName","footSummary","headSummary","saveImmediately","selectable","multiple","primaryField","hideQuickSaveBtn","selected","placeholder","autoFillHeight"],t.defaultProps={keyField:"id",canAccessSuperData:!1,lazyRenderAfter:100},(0,r.Cg)([h.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[]),(0,r.Sn)("design:returntype",void 0)],t.prototype,"getPopOverContainer",null),(0,r.Cg)([h.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[Object,Number,Number]),(0,r.Sn)("design:returntype",void 0)],t.prototype,"subFormRef",null),(0,r.Cg)([h.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[]),(0,r.Sn)("design:returntype",void 0)],t.prototype,"reset",null),(0,r.Cg)([h.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[Object,Number]),(0,r.Sn)("design:returntype",void 0)],t.prototype,"rowClassName",null),(0,r.Cg)([h.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[Object,Number]),(0,r.Sn)("design:returntype",void 0)],t.prototype,"expandedRowClassName",null),(0,r.Cg)([h.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[Object,Number]),(0,r.Sn)("design:returntype",void 0)],t.prototype,"expandedRowRender",null),(0,r.Cg)([h.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[Object,Number,Array]),(0,r.Sn)("design:returntype",void 0)],t.prototype,"rowExpandable",null),(0,r.Cg)([h.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[]),(0,r.Sn)("design:returntype",Promise)],t.prototype,"handleSave",null),(0,r.Cg)([h.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[Object,Object,Array,Array,Object,Object]),(0,r.Sn)("design:returntype",void 0)],t.prototype,"handleQuickSave",null),(0,r.Cg)([h.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[Object,Object,Object,Boolean,Object]),(0,r.Sn)("design:returntype",void 0)],t.prototype,"handleQuickChange",null),(0,r.Cg)([h.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[Object,Object,Object]),(0,r.Sn)("design:returntype",void 0)],t.prototype,"handleAction",null),(0,r.Cg)([h.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[Array,Array,Array]),(0,r.Sn)("design:returntype",Promise)],t.prototype,"handleSelected",null),(0,r.Cg)([h.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[Object]),(0,r.Sn)("design:returntype",Promise)],t.prototype,"handleSort",null),(0,r.Cg)([h.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[Object]),(0,r.Sn)("design:returntype",Promise)],t.prototype,"handleFilter",null),(0,r.Cg)([h.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[String,Object]),(0,r.Sn)("design:returntype",Promise)],t.prototype,"handleSearch",null),(0,r.Cg)([h.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[Object,Object,Number]),(0,r.Sn)("design:returntype",Promise)],t.prototype,"handleRowClick",null),(0,r.Cg)([h.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[Object,Object,Number]),(0,r.Sn)("design:returntype",Promise)],t.prototype,"handleRowDbClick",null),(0,r.Cg)([h.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[Object,Object,Number]),(0,r.Sn)("design:returntype",Promise)],t.prototype,"handleRowMouseEnter",null),(0,r.Cg)([h.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[Object,Object,Number]),(0,r.Sn)("design:returntype",Promise)],t.prototype,"handleRowMouseLeave",null),(0,r.Cg)([h.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[Number,Number,Array]),(0,r.Sn)("design:returntype",Promise)],t.prototype,"handleOrderChange",null),(0,r.Cg)([h.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[]),(0,r.Sn)("design:returntype",Promise)],t.prototype,"handleSaveOrder",null),(0,r.Cg)([h.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[Object]),(0,r.Sn)("design:returntype",void 0)],t.prototype,"getRef",null),t}(o.Component),k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.C6)(t,e),t.prototype.receive=function(e,t){var n,r,o,a=this.context;return(null===(n=this.props)||void 0===n?void 0:n.host)?null===(o=(r=this.props.host).receive)||void 0===o?void 0:o.call(r,e,t):t?a.send(t,e):void 0},t.prototype.reload=function(e,t,n){var r,o,a,i,l=this.context;return null===(r=null==l?void 0:l.parent)||void 0===r||r.getComponents(),(null===(o=this.props)||void 0===o?void 0:o.host)?null===(i=(a=this.props.host).reload)||void 0===i?void 0:i.call(a,e,t,n):e?l.reload(e,n):void 0},t.prototype.setData=function(e,t,n,o){var a;return(0,r.sH)(this,void 0,void 0,(function(){var i,l,s,d,c,u,p;return(0,r.YH)(this,(function(m){switch(m.label){case 0:return i=this.props.store,l=i.data.rows.length,void 0===n?[3,1]:(s=(0,r.fX)([],(0,r.zs)(i.data.rows),!1),String(n).split(",").forEach((function(t){var n=Number(t);s.splice(n,1,e)})),[2,i.updateData({rows:s},void 0,t)]);case 1:if(void 0===o)return[3,6];d=(0,r.fX)([],(0,r.zs)(i.data.rows),!1),c=0,m.label=2;case 2:return c<l?(u=d[c],[4,(0,h.JnN)(o,u)]):[3,5];case 3:m.sent()&&d.splice(c,1,e),m.label=4;case 4:return c++,[3,2];case 5:return[2,i.updateData({rows:d},void 0,t)];case 6:return p=(0,r.Cl)((0,r.Cl)({},e),{rows:null!==(a=e.rows)&&void 0!==a?a:e.items}),[2,i.updateData(p,void 0,t)]}}))}))},t.prototype.getData=function(){var e=this.props,t=e.store,n=e.data;return t.getData(n)},(0,r.Cg)([(0,h.A49)({type:"table2",storeType:h._rs.name,name:"table2",isolateScope:!0})],t)}(R)}}]);