"use strict";(self.webpackChunktestAmis=self.webpackChunktestAmis||[]).push([[8194],{98194:function(t,e,n){n.r(e),n.d(e,{IFrameRenderer:function(){return i},default:function(){return a}});var s=n(31635),r=n(96540),o=n(8096),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.IFrameRef=r.createRef(),e.state={width:e.props.width||"100%",height:e.props.height||"100%"},e}return(0,s.C6)(e,t),e.prototype.componentDidMount=function(){window.addEventListener("message",this.onMessage)},e.prototype.componentDidUpdate=function(t){var e=this.props.data;e!==t.data?this.postMessage("update",e):this.props.width===t.width&&this.props.height===t.height||this.setState({width:this.props.width||"100%",height:this.props.height||"100%"})},e.prototype.componentWillUnmount=function(){window.removeEventListener("message",this.onMessage)},e.prototype.validateURL=function(t){return!(!t||"string"!=typeof t||!/^data:([a-zA-Z0-9]+\/[a-zA-Z0-9]+);base64,.*/.test(t))||!(t&&"string"==typeof t&&!/^(\.\/|\.\.\/|\/|(blob\:)?https?\:\/\/|\/\/)/.test(t))},e.prototype.onMessage=function(t){var e,n,r;return(0,s.sH)(this,void 0,void 0,(function(){var a,i,p,d,l,c,h,u,m,v,g;return(0,s.YH)(this,(function(y){switch(y.label){case 0:return a=this.props,i=a.events,p=a.onEvent,d=a.onAction,l=a.data,"string"!=typeof(null===(e=null==t?void 0:t.data)||void 0===e?void 0:e.type)?[2]:(c=(0,s.zs)(t.data.type.split(":"),2),h=c[0],u=c[1],"amis"===h&&u?"resize"===u&&t.data.data?(this.setState({width:t.data.data.width||"100%",height:t.data.data.height||"100%"}),[3,4]):[3,1]:[2]);case 1:return(m=null==p?void 0:p[u])&&(null===(n=m.actions)||void 0===n?void 0:n.length)?(v=(0,o.ESp)(u,{env:null===(r=this.props)||void 0===r?void 0:r.env,nativeEvent:t,data:(0,o.ed2)(l,t.data.data),scoped:this.context}),[4,(0,o.L9B)(m.actions,this,v)]):[3,3];case 2:if(y.sent(),v.prevented)return[2];y.label=3;case 3:i&&(g=i[u])&&d(t,g,(0,o.ed2)(l,t.data.data)),y.label=4;case 4:return[2]}}))}))},e.prototype.onLoad=function(){var t=this.props,e=t.src,n=t.data;e&&this.postMessage("init",n)},e.prototype.reload=function(t,e){if(e)return this.receive(e);var n=this.props,s=n.src,r=n.data;s&&(this.IFrameRef.current.src=(0,o.GvO)(s,r,"| raw"))},e.prototype.receive=function(t){var e=this.props,n=e.src,s=e.data,r=(0,o.ed2)(s,t);this.postMessage("receive",r),(0,o.B92)(n,n,s,r)&&(this.IFrameRef.current.src=(0,o.GvO)(n,r,"| raw"))},e.prototype.postMessage=function(t,e){var n,s;null===(s=null===(n=this.IFrameRef.current)||void 0===n?void 0:n.contentWindow)||void 0===s||s.postMessage({type:"amis:".concat(t),data:JSON.parse(JSON.stringify(e))},"*")},e.prototype.render=function(){var t=this.state,e=t.width,n=t.height,a=this.props,i=a.className,p=a.src,d=a.name,l=a.frameBorder,c=a.data,h=a.style,u=a.allow,m=a.sandbox,v=a.referrerpolicy,g=a.translate,y=a.id,f=a.wrapperCustomStyle,C=a.env,w=a.themeCss;a.baseControlClassName;var S=a.classnames,b={};void 0!==e&&(b.width=e),void 0!==n&&(b.height=n),h=(0,s.Cl)((0,s.Cl)({},b),h);var F=p?(0,o.GvO)(p,c,"| raw"):void 0;return this.validateURL(F)?("https:"===location.protocol&&F&&F.startsWith("http://")&&C.notify("error",g("Iframe.invalidProtocol")),r.createElement(r.Fragment,null,r.createElement("iframe",{name:d,className:S("IFrame",i,(0,o.NH8)((0,s.Cl)((0,s.Cl)({},this.props),{name:"baseControlClassName",id:y,themeCss:w})),(0,o.NH8)((0,s.Cl)((0,s.Cl)({},this.props),{name:"wrapperCustomStyle",id:y,themeCss:f}))),frameBorder:l,style:h,ref:this.IFrameRef,onLoad:this.onLoad,src:F,allow:u,referrerPolicy:v,sandbox:m}),r.createElement(o.z4D,(0,s.Cl)({},this.props,{config:{wrapperCustomStyle:f,id:y,themeCss:w,classNames:[{key:"baseControlClassName"}]},env:C})))):r.createElement("p",null,g("Iframe.invalid"))},e.propsList=["src","className"],e.defaultProps={className:"",frameBorder:0},(0,s.Cg)([o.d6t,(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[MessageEvent]),(0,s.Sn)("design:returntype",Promise)],e.prototype,"onMessage",null),(0,s.Cg)([o.d6t,(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[]),(0,s.Sn)("design:returntype",void 0)],e.prototype,"onLoad",null),(0,s.Cg)([o.d6t,(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[Object,Object]),(0,s.Sn)("design:returntype",void 0)],e.prototype,"reload",null),(0,s.Cg)([o.d6t,(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[Object]),(0,s.Sn)("design:returntype",void 0)],e.prototype,"receive",null),(0,s.Cg)([o.d6t,(0,s.Sn)("design:type",Function),(0,s.Sn)("design:paramtypes",[String,Object]),(0,s.Sn)("design:returntype",void 0)],e.prototype,"postMessage",null),e}(r.Component),i=function(t){function e(e,n){var s=t.call(this,e)||this;return n.registerComponent(s),s}return(0,s.C6)(e,t),e.prototype.componentWillUnmount=function(){this.context.unRegisterComponent(this),t.prototype.componentWillUnmount.call(this)},e.contextType=o.MzX,(0,s.Cg)([(0,o.A49)({type:"iframe"}),(0,s.Sn)("design:paramtypes",[Object,Object])],e)}(a)}}]);