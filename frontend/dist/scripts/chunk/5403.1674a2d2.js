"use strict";(self.webpackChunktestAmis=self.webpackChunktestAmis||[]).push([[5403],{85403:function(e,t,n){n.r(t),n.d(t,{App:function(){return l},default:function(){return s}});var a=n(31635),r=n(96540),o=n(65408),i=n(8096),l=function(e){function t(t){var n,a,r,o=this;o=e.call(this,t)||this;var i=t.store;return i.syncProps(t,void 0,["pages"]),i.updateActivePage(Object.assign({},null!==(n=t.env)&&void 0!==n?n:{},{showFullBreadcrumbPath:null!==(a=t.showFullBreadcrumbPath)&&void 0!==a&&a,showBreadcrumbHomePath:null===(r=t.showBreadcrumbHomePath)||void 0===r||r})),t.env.watchRouteChange&&(o.unWatchRouteChange=t.env.watchRouteChange((function(){var e,n,a;return i.updateActivePage(Object.assign({},null!==(e=t.env)&&void 0!==e?e:{},{showFullBreadcrumbPath:null!==(n=t.showFullBreadcrumbPath)&&void 0!==n&&n,showBreadcrumbHomePath:null===(a=t.showBreadcrumbHomePath)||void 0===a||a}))}))),o}return(0,a.C6)(t,e),t.prototype.componentDidMount=function(){return(0,a.sH)(this,void 0,void 0,(function(){var e,t,n;return(0,a.YH)(this,(function(a){switch(a.label){case 0:return e=this.props,t=e.data,[4,(0,e.dispatchEvent)("init",t,this)];case 1:return(null==(n=a.sent())?void 0:n.prevented)||this.reload(),[2]}}))}))},t.prototype.componentDidUpdate=function(e){var t,n,r;return(0,a.sH)(this,void 0,void 0,(function(){var o,l;return(0,a.YH)(this,(function(a){return o=this.props,(l=o.store).syncProps(o,e,["pages"]),(0,i.B92)(e.api,o.api,e.data,o.data)?this.reload():o.location&&o.location!==e.location&&l.updateActivePage(Object.assign({},null!==(t=o.env)&&void 0!==t?t:{},{showFullBreadcrumbPath:null!==(n=o.showFullBreadcrumbPath)&&void 0!==n&&n,showBreadcrumbHomePath:null===(r=o.showBreadcrumbHomePath)||void 0===r||r})),[2]}))}))},t.prototype.componentWillUnmount=function(){var e;null===(e=this.unWatchRouteChange)||void 0===e||e.call(this)},t.prototype.reload=function(e,t,n,r,o){return(0,a.sH)(this,void 0,void 0,(function(){var e,n,r,l,s,c,d,u,p,h;return(0,a.YH)(this,(function(a){switch(a.label){case 0:return t?[2,this.receive(t,void 0,o)]:(e=this.props,n=e.api,r=e.store,l=e.env,s=e.showFullBreadcrumbPath,c=void 0!==s&&s,d=e.showBreadcrumbHomePath,u=void 0===d||d,p=e.locale,(0,i.Amo)(n,r.data)?[4,r.fetchInitData(n,r.data,{})]:[3,2]);case 1:h=a.sent(),l.replaceText&&(h.data=(0,i.eer)(h.data,l.replaceText,l.replaceTextIgnoreKeys)),(null==h?void 0:h.data.pages)&&(h.data=(0,i.Dzd)(h.data,p),r.setPages(h.data.pages),r.updateActivePage(Object.assign({},null!=l?l:{},{showFullBreadcrumbPath:c,showBreadcrumbHomePath:u}))),a.label=2;case 2:return[2,r.data]}}))}))},t.prototype.receive=function(e,t,n){return(0,a.sH)(this,void 0,void 0,(function(){return(0,a.YH)(this,(function(t){return this.props.store.updateData(e,void 0,n),[2,this.reload()]}))}))},t.prototype.resolveDefinitions=function(e){var t,n=this.props,a=n.resolveDefinitions,r=null===(t=n.store.schema)||void 0===t?void 0:t.definitions;return(null==r?void 0:r[e])||a(e)},t.prototype.handleNavClick=function(e){e.preventDefault();var t=this.props.env,n=e.currentTarget.getAttribute("href");t.jumpTo(n,void 0,this.props.data)},t.prototype.renderHeader=function(){var e=this.props,t=e.classnames,n=e.brandName,a=e.header,i=e.render,l=e.store,s=e.logo,c=e.env;return a||s||n?r.createElement(r.Fragment,null,r.createElement("div",{className:t("Layout-brandBar")},r.createElement("div",{onClick:l.toggleOffScreen,className:t("Layout-offScreenBtn")},r.createElement("i",{className:"bui-icon iconfont icon-collapse"})),r.createElement("div",{className:t("Layout-brand")},s&&~s.indexOf("<svg")?r.createElement(o.Ed,{className:t("AppLogo-html"),html:s,filterHtml:c.filterHtml}):s?r.createElement("img",{className:t("AppLogo"),src:s}):r.createElement("span",{className:"visible-folded "},null==n?void 0:n.substring(0,1)),r.createElement("span",{className:"hidden-folded m-l-sm"},n))),r.createElement("div",{className:t("Layout-headerBar")},r.createElement("a",{onClick:l.toggleFolded,type:"button",className:t("AppFoldBtn")},r.createElement("i",{className:"fa fa-".concat(l.folded?"indent":"dedent"," fa-fw")})),a?i("header",a):null)):null},t.prototype.renderAside=function(){var e=this,t=this.props,n=t.store,a=t.env,l=t.asideBefore,s=t.asideAfter,c=t.render,d=t.data;return r.createElement(r.Fragment,null,l?c("aside-before",l):null,r.createElement(o.ae,{navigations:n.navigations,renderLink:function(t,a){var l=t.link;t.active;var s=t.toggleExpand,c=t.classnames,u=t.depth,p=t.subHeader,h=[];if(!1===l.visible)return null;!p&&l.children&&l.children.some((function(e){return null==e?void 0:e.visible}))&&h.push(r.createElement("span",{key:"expand-toggle",className:c("AsideNav-itemArrow"),onClick:function(e){return s(l,e)}}));var m="string"==typeof l.badge?(0,i.pbD)(l.badge,d):l.badge;return null!=m&&h.push(r.createElement("b",{key:"badge",className:c("AsideNav-itemBadge",l.badgeClassName||"bg-info")},m)),!p&&l.icon?h.push(r.createElement(o.In,{key:"icon",cx:c,icon:l.icon,className:"AsideNav-itemIcon"})):n.folded&&1===u&&!p&&h.push(r.createElement("i",{key:"icon",className:c("AsideNav-itemIcon",l.children?"fa fa-folder":"fa fa-info")})),h.push(r.createElement("span",{className:c("AsideNav-itemLabel"),key:"label"},"string"==typeof l.label?(0,i.pbD)(l.label,d):l.label)),l.path?/^https?\:/.test(l.path)?r.createElement("a",{target:"_blank",key:"link",href:l.path,rel:"noopener"},h):r.createElement("a",{key:"link",onClick:e.handleNavClick,href:l.path||l.children&&l.children[0].path},h):r.createElement("a",{key:"link",onClick:l.children?function(){return s(l)}:void 0},h)},isActive:function(e){return!!a.isCurrentUrl(null==e?void 0:e.path,e)}}),s?c("aside-before",s):null)},t.prototype.renderFooter=function(){var e=this.props,t=e.render,n=e.footer;return n?t("footer",n):null},t.prototype.render=function(){var e,t=this,n=this.props,a=n.classnames,i=n.store,l=n.render,s=n.showBreadcrumb,c=void 0===s||s,d=n.loadingConfig;return r.createElement(o.PE,{header:this.renderHeader(),aside:this.renderAside(),footer:this.renderFooter(),folded:i.folded,offScreen:i.offScreen,contentClassName:a("AppContent")},i.activePage&&i.schema?r.createElement(r.Fragment,null,c&&i.bcn.length?r.createElement("ul",{className:a("AppBcn")},i.bcn.map((function(e,n){return r.createElement("li",{key:n,className:a("AppBcn-item")},e.path?r.createElement("a",{href:e.path,onClick:t.handleNavClick},e.label):n!==i.bcn.length-1?r.createElement("a",null,e.label):e.label)}))):null,r.createElement("div",{className:a("AppBody")},l("page",i.schema,{key:"".concat(null===(e=i.activePage)||void 0===e?void 0:e.id,"-").concat(i.schemaKey),data:i.pageData,resolveDefinitions:this.resolveDefinitions}))):i.pages&&!i.activePage?r.createElement(o.Mk,null,r.createElement("div",{className:"text-center"},"页面不存在")):null,r.createElement(o.y$,{loadingConfig:d,overlay:!0,show:i.loading||!i.pages,size:"lg"}))},t.propsList=["brandName","logo","header","asideBefore","asideAfter","pages","footer"],t.defaultProps={},(0,a.Cg)([i.d6t,(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[String]),(0,a.Sn)("design:returntype",void 0)],t.prototype,"resolveDefinitions",null),(0,a.Cg)([i.d6t,(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[Object]),(0,a.Sn)("design:returntype",void 0)],t.prototype,"handleNavClick",null),t}(r.Component),s=function(e){function t(t,n){var a=e.call(this,t)||this;return n.registerComponent(a),a}return(0,a.C6)(t,e),t.prototype.componentWillUnmount=function(){this.context.unRegisterComponent(this),e.prototype.componentWillUnmount.call(this)},t.prototype.setData=function(e,t){return this.props.store.updateData(e,void 0,t)},t.prototype.getData=function(){return this.props.store.data},t.contextType=i.MzX,(0,a.Cg)([(0,i.A49)({type:"app",storeType:i.two.name}),(0,a.Sn)("design:paramtypes",[Object,Object])],t)}(l)}}]);