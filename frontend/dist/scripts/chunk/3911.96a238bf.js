"use strict";(self.webpackChunktestAmis=self.webpackChunktestAmis||[]).push([[3911],{13911:function(e,t,n){n.r(t),n.d(t,{ChainedSelectControlRenderer:function(){return m},default:function(){return v}});var i=n(31635),a=n(96540),o=n(32485),l=n.n(o),s=n(8096),r=n(65408),c=n(66283),d=n(7309),p=n.n(d),u=n(62193),h=n.n(u),v=function(e){function t(t){var n=e.call(this,t)||this;return n.state={stack:[]},n.handleChange=n.handleChange.bind(n),n.loadMore=n.loadMore.bind(n),n}return(0,i.C6)(t,e),t.prototype.componentDidMount=function(){var e,t;this.props.formInited||!this.props.addHook?this.loadMore():null===(t=(e=this.props).addHook)||void 0===t||t.call(e,this.loadMore,"init")},t.prototype.componentDidUpdate=function(e){var t=this.props;e.options!==t.options?this.setState({stack:[]}):t.formInited&&t.value!==e.value&&this.loadMore()},t.prototype.doAction=function(e,t,n){var i,a,o=this.props,l=o.resetValue,r=o.onChange,c=o.formStore,d=o.store,p=o.name,u=null==e?void 0:e.actionType;if("clear"===u)r("");else if("reset"===u){var h=null!==(a=(0,s.dnO)(null!==(i=null==c?void 0:c.pristine)&&void 0!==i?i:null==d?void 0:d.pristine,p))&&void 0!==a?a:l;r(null!=h?h:"")}},t.prototype.array2value=function(e,t){void 0===t&&(t=!1);var n=this.props,i=n.delimiter,a=n.joinValues,o=n.extractValue;return t?a?e.join(i||","):e:a?e.join(i||","):o?e.map((function(e){return e.value||e})):e},t.prototype.loadMore=function(){for(var e=this,t=this.props,n=t.value,a=t.delimiter,o=t.onChange,l=t.joinValues,r=t.extractValue,c=t.source,d=t.data,p=t.env,u=t.dispatchEvent,v=Array.isArray(n)?n.concat():n&&"string"==typeof n?n.split(a||","):[],m=0,C=this.state.stack.length;m<C&&v[m]&&this.state.stack[m].parentId==(l||r?v[m]:v[m].value);)m++;if(v[m]&&p&&(0,s.Amo)(c,d)){var f=l||r?v[m]:v[m].value,g=this.state.stack.concat();g.splice(m,g.length-m),g.push({parentId:f,loading:!0,options:[]}),this.setState({stack:g},(function(){p.fetcher(c,(0,i.Cl)((0,i.Cl)({},d),{value:v,level:m+1,parentId:f,parent:v[m]})).then((function(t){return(0,i.sH)(e,void 0,void 0,(function(){var e,a,l,r,c,d,p,C;return(0,i.YH)(this,(function(i){switch(i.label){case 0:return e=this.state.stack.concat(),a=t.data?t.data.value:void 0,l=(null===(d=null==t?void 0:t.data)||void 0===d?void 0:d.options)||(null===(p=null==t?void 0:t.data)||void 0===p?void 0:p.items)||(null===(C=null==t?void 0:t.data)||void 0===C?void 0:C.rows)||t.data||[],e.splice(m,e.length-m),void 0===a?[3,2]:(v.splice(m+1,n.length-m-1),v.push(a),r=this.array2value(v,!0),[4,u("change",(0,s.RKM)(this.props,{value:r}))]);case 1:if(null==(c=i.sent())?void 0:c.prevented)return[2];o(r),i.label=2;case 2:return e.push({options:l,parentId:f,loading:!1,visible:Array.isArray(l)&&!h()(l)}),this.setState({stack:e},this.loadMore),[2]}}))}))})).catch((function(e){!(null==c?void 0:c.silent)&&p.notify("error",e.message)}))}))}},t.prototype.handleChange=function(e,t){return(0,i.sH)(this,void 0,void 0,(function(){var n,a,o,l,r,c,d,p,u,h;return(0,i.YH)(this,(function(i){switch(i.label){case 0:return n=this.props,a=n.value,o=n.delimiter,l=n.onChange,r=n.joinValues,n.extractValue,c=n.dispatchEvent,n.data,(d=Array.isArray(a)?a.concat():a&&"string"==typeof a?a.split(o||","):[]).splice(e,d.length-e),void 0!==(p=r?t.value:t)&&d.push(p),u=this.array2value(d),[4,c("change",(0,s.RKM)(this.props,{value:u}))];case 1:return(null==(h=i.sent())?void 0:h.prevented)||l(u),[2]}}))}))},t.prototype.reload=function(){var e=this.props.reloadOptions;e&&e()},t.prototype.renderStatic=function(e){void 0===e&&(e="-");var t=this.props,n=t.options,o=void 0===n?[]:n,l=t.labelField,s=void 0===l?"label":l,r=t.valueField,c=void 0===r?"value":r,d=t.classPrefix,u=t.classnames,h=t.className,v=t.value,m=t.delimiter,C=(0,i.fX)([{options:o,visible:!0}],(0,i.zs)(this.state.stack||[]),!1),f=Array.isArray(v)?v.concat():v&&"string"==typeof v?v.split(m||","):[];return(null==f?void 0:f.length)>0&&(e=f.map((function(e,t){var n,i=C[t]||{},a=i.options;return!1===i.visible?null:a&&a.length&&null!==(n=(p()(a,(function(t){return e===t[c]}))||{})[s])&&void 0!==n?n:e})).filter((function(e){return null!=e})).join(" > ")),a.createElement("div",{className:u("".concat(d,"SelectStaticControl"),h)},e)},t.prototype.render=function(){var e=this,t=this.props,n=t.options,o=t.classPrefix,c=t.className,d=t.style;t.inline;var p=t.loading,u=t.value,h=t.delimiter;t.joinValues,t.extractValue,t.multiple;var v=t.mobileUI,m=t.env,C=t.testIdBuilder,f=t.popoverClassName,g=(0,i.Tt)(t,["options","classPrefix","className","style","inline","loading","value","delimiter","joinValues","extractValue","multiple","mobileUI","env","testIdBuilder","popoverClassName"]),y=Array.isArray(u)?u.concat():u&&"string"==typeof u?u.split(h||","):[],b=this.props,S=b.themeCss,N=b.id,k=this.state.stack.find((function(e){return e.loading}));return a.createElement("div",{className:l()("".concat(o,"ChainedSelectControl"),c)},a.createElement(r.l6,(0,i.Cl)({},g,{mobileUI:v,popOverContainer:v?null==m?void 0:m.getModalContainer:g.popOverContainer||(null==m?void 0:m.getModalContainer),className:l()((0,s.NH8)((0,i.Cl)((0,i.Cl)({},this.props),{name:"chainedSelectControlClassName",id:N,themeCss:S}))),popoverClassName:l()(f,(0,s.NH8)((0,i.Cl)((0,i.Cl)({},this.props),{name:"chainedSelectPopoverClassName",id:N,themeCss:S}))),controlStyle:d,classPrefix:o,key:"base",testIdBuilder:null==C?void 0:C.getChild("base"),options:Array.isArray(n)?n:[],value:y[0],onChange:this.handleChange.bind(this,0),loading:p,inline:!0})),this.state.stack.map((function(t,n){var c=t.options,p=t.loading;return!1===t.visible||p?null:a.createElement(r.l6,(0,i.Cl)({},g,{mobileUI:v,popOverContainer:v?m.getModalContainer:g.popOverContainer||(null==m?void 0:m.getModalContainer),classPrefix:o,key:"x-".concat(n+1),testIdBuilder:null==C?void 0:C.getChild("x-".concat(n+1)),options:Array.isArray(c)?c:[],value:y[n+1],onChange:e.handleChange.bind(e,n+1),inline:!0,controlStyle:d,className:l()((0,s.NH8)((0,i.Cl)((0,i.Cl)({},e.props),{name:"chainedSelectControlClassName",id:N,themeCss:S}))),popoverClassName:l()(f,(0,s.NH8)((0,i.Cl)((0,i.Cl)({},e.props),{name:"chainedSelectPopoverClassName",id:N,themeCss:S})))}))})),k&&a.createElement(r.y$,{size:"sm",className:l()("".concat(o,"ChainedSelectControl-spinner"))}),a.createElement(s.z4D,(0,i.Cl)({},this.props,{config:{themeCss:S,classNames:[{key:"chainedSelectControlClassName",weights:{focused:{suf:".is-opened:not(.is-mobile)"},disabled:{suf:".is-disabled"}}},{key:"chainedSelectPopoverClassName",weights:{default:{suf:" .".concat(o,"Select-option")},hover:{suf:" .".concat(o,"Select-option.is-highlight")},focused:{inner:".".concat(o,"Select-option.is-active")}}}],id:N},env:m})))},t.defaultProps={clearable:!1,searchable:!1,multiple:!0},(0,i.Cg)([(0,c.E)(),(0,i.Sn)("design:type",Function),(0,i.Sn)("design:paramtypes",[]),(0,i.Sn)("design:returntype",void 0)],t.prototype,"render",null),t}(a.Component),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.C6)(t,e),(0,i.Cg)([(0,s.QqA)({type:"chained-select",sizeMutable:!1})],t)}(v)}}]);