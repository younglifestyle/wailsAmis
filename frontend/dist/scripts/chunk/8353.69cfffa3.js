"use strict";(self.webpackChunktestAmis=self.webpackChunktestAmis||[]).push([[8353],{98353:function(e,t,n){n.r(t),n.d(t,{ComboControlRenderer:function(){return A},KVControlRenderer:function(){return V},KVSControlRenderer:function(){return x},default:function(){return I}});var a=n(31635),r=n(96540),i=n(40961),l=n(88055),o=n.n(l),s=n(8096),d=n(65408),u=n(10246),m=n(7309),c=n.n(m),p=n(50104),h=n.n(p),f=n(50346),b=n(11331),v=n.n(b),g=n(2404),y=n.n(g);function C(e,t){return t.reduce((function(t,n){return t[n]=(0,s.FL9)(n,e),t}),{})}var I=function(e){function t(t){var n=e.call(this,t)||this;n.subFormDefaultValues=[],n.keys=[],n.toDispose=[],n.id=(0,s.OsD)(),n.refsMap={},n.makeFormRef=h()((function(e){return function(t){return n.formRef(t,e)}})),n.memoizedFormatValue=h()((function(e,t,n,r,i){return(0,s.ed2)((0,s.C5M)(i,(0,a.Cl)({index:r,__index:r},i)),(0,a.Cl)((0,a.Cl)({},n),Array.isArray(t)?C(i,t):null))}),(function(e,t,n,a,r){return Array.isArray(t)?JSON.stringify([n,a,r,C(r,t)]):e?JSON.stringify([n,a]):JSON.stringify([n,a,r])})),n.handleChange=n.handleChange.bind(n),n.handleRadioChange=n.handleRadioChange.bind(n),n.handleSingleFormChange=n.handleSingleFormChange.bind(n),n.handleSingleFormInit=n.handleSingleFormInit.bind(n),n.handleFormInit=n.handleFormInit.bind(n),n.handleAction=n.handleAction.bind(n),n.addItem=n.addItem.bind(n),n.deleteItem=n.deleteItem.bind(n),n.dragTipRef=n.dragTipRef.bind(n),n.flush=n.flush.bind(n),n.handleComboTypeChange=n.handleComboTypeChange.bind(n),n.handleSubFormValid=n.handleSubFormValid.bind(n),n.defaultValue=(0,a.Cl)({},t.scaffold);var r=t.store;t.value;var i=t.multiple,l=t.formItem,o=t.addHook;return r.config({multiple:i,minLength:n.resolveVariableProps(t,"minLength"),maxLength:n.resolveVariableProps(t,"maxLength"),length:n.getValueAsArray(t).length}),l&&(0,f._n)(l)&&l.setSubStore(r),o&&n.toDispose.push(o(n.flush,"flush")),n}return(0,a.C6)(t,e),t.prototype.componentDidUpdate=function(e){var t=this.props;if((0,s.TIf)(["minLength","maxLength","value"],e,t)||this.resolveVariableProps(e,"minLength")!==this.resolveVariableProps(t,"minLength")||this.resolveVariableProps(e,"maxLength")!==this.resolveVariableProps(t,"maxLength")){var n=t.store,r=t.multiple,i=this.getValueAsArray(t);n.config({multiple:r,minLength:this.resolveVariableProps(t,"minLength"),maxLength:this.resolveVariableProps(t,"maxLength"),length:i.length}),n.activeKey>=i.length&&n.setActiveKey(Math.max(0,i.length-1)),t.value!==e.value&&!e.formInited&&this.subFormDefaultValues.length&&(this.subFormDefaultValues=this.subFormDefaultValues.map((function(e,t){return(0,a.Cl)((0,a.Cl)({},e),{values:i[t]})})))}},t.prototype.componentWillUnmount=function(){var e,t,n,a,r=this.props.formItem;r&&(0,f._n)(r)&&r.setSubStore(null),this.toDispose.forEach((function(e){return e()})),this.toDispose=[],null===(t=(e=this.memoizedFormatValue.cache).clear)||void 0===t||t.call(e),null===(a=(n=this.makeFormRef.cache).clear)||void 0===a||a.call(n)},t.prototype.resolveVariableProps=function(e,t){var n={minLength:0,maxLength:1/0},a=e[t];if(!a)return n[t];if("string"==typeof a)if((0,s.joH)(a)){var r=(0,s.GvO)(a,e.data,"| raw");a="number"==typeof r&&r>=0?r:n[t]}else{var i=parseInt(a,10);a=isNaN(i)?n[t]:i}return a},t.prototype.doAction=function(e,t,n,a){var r,i,l,o,d=null==e?void 0:e.actionType,u=this.props,m=u.onChange,c=u.resetValue,p=u.formStore,h=u.store,f=u.name;if("addItem"===d)this.addItemValue(null!==(r=null==a?void 0:a.item)&&void 0!==r?r:{});else if("clear"===d)m("");else if("reset"===d){var b=null!==(o=(0,s.dnO)(null!==(i=null==p?void 0:p.pristine)&&void 0!==i?i:null===(l=null==h?void 0:h.parentStore)||void 0===l?void 0:l.pristine,f))&&void 0!==o?o:c;m(null!=b?b:"")}},t.prototype.addItemValue=function(e){var t=this.props,n=t.flat,a=t.joinValues,r=t.addattop,i=t.delimiter,l=t.disabled,o=t.submitOnChange;if(!l){var d=this.getValueAsArray();!0===r?(this.keys.unshift((0,s.OsD)()),d.unshift(e)):(d.push(e),this.keys.push((0,s.OsD)())),n&&a&&(d=d.join(i||",")),this.props.onChange(d,o,!0)}},t.prototype.getValueAsArray=function(e){void 0===e&&(e=this.props);var t=e.flat,n=e.joinValues,a=e.delimiter;e.type,e.formItem;var r=e.getValue();return n&&t&&"string"==typeof r?r.split(a||","):Array.isArray(r)?r.concat():[]},t.prototype.addItemWith=function(e){var t,n,r=this.props,i=r.flat,l=r.joinValues,o=r.addattop,d=r.delimiter,u=r.scaffold,m=r.disabled,c=r.submitOnChange;if(!m){var p=this.getValueAsArray();p.push(i?null!==(n=null!==(t=e.scaffold)&&void 0!==t?t:u)&&void 0!==n?n:"":(0,a.Cl)({},e.scaffold||u)),this.keys.push((0,s.OsD)()),i&&l&&(p=p.join(d||",")),!0===o&&(this.keys.unshift(this.keys.pop()),p.unshift(p.pop())),this.props.onChange(p,c,!0)}},t.prototype.addItem=function(){return(0,a.sH)(this,void 0,void 0,(function(){var e,t,n,r,i,l,d,u,m,c,p,h,f;return(0,a.YH)(this,(function(b){switch(b.label){case 0:return e=this.props,t=e.flat,n=e.joinValues,r=e.addattop,i=e.delimiter,l=e.scaffold,d=e.disabled,u=e.submitOnChange,m=e.dispatchEvent,c=e.store,d?[2]:(p=this.getValueAsArray(),[4,m("add",(0,s.RKM)(this.props,{value:t&&n?p.join(i||","):o()(p)}))]);case 1:return(null==(h=b.sent())?void 0:h.prevented)||(p.push(t?null!=l?l:"":(0,a.Cl)({},l)),this.keys.push((0,s.OsD)()),t&&n&&(p=p.join(i||",")),f=this.keys.length-1,!0===r&&(this.keys.unshift(this.keys.pop()),p.unshift(p.pop()),f=0),c.setActiveKey(f),this.props.onChange(p,u,!0)),[2]}}))}))},t.prototype.deleteItem=function(e){var t,n;return(0,a.sH)(this,void 0,void 0,(function(){var r,i,l,d,u,m,c,p,h,f,b,v,g,y,C;return(0,a.YH)(this,(function(a){switch(a.label){case 0:return r=this.props,i=r.flat,l=r.joinValues,d=r.delimiter,u=r.disabled,m=r.deleteApi,c=r.deleteConfirmText,p=r.data,h=r.env,f=r.translate,b=r.dispatchEvent,v=r.submitOnChange,u?[2]:(g=this.getValueAsArray(),y=(0,s.ed2)(p,g[e]),[4,b("delete",(0,s.RKM)(this.props,{key:e,value:i&&l?g.join(d||","):o()(g),item:g[e]}))]);case 1:return(null==(C=a.sent())?void 0:C.prevented)?[2]:(0,s.Amo)(m,y)?[4,h.confirm(c?(0,s.pbD)(c,y):f("deleteConfirm"))]:[3,4];case 2:return a.sent()?[4,h.fetcher(m,y)]:[2];case 3:if(!a.sent().ok)return!(null==m?void 0:m.silent)&&h.notify("error",null!==(n=null===(t=null==m?void 0:m.messages)||void 0===t?void 0:t.failed)&&void 0!==n?n:f("deleteFailed")),[2];a.label=4;case 4:return this.keys.splice(e,1),g.splice(e,1),i&&l&&(g=g.join(d||",")),this.props.onChange(g,v,!0),[2]}}))}))},t.prototype.handleChange=function(e,t,n){var r,i,l,o,d=n.index,u=this.props,m=u.flat,c=u.store,p=u.joinValues,h=u.delimiter,b=u.disabled,v=u.submitOnChange,g=u.type,y=u.syncFields,C=u.name;if(!b){Array.isArray(y)&&y.forEach((function(t){(null==C?void 0:C.startsWith(t))&&(e=(0,a.Cl)({},e),(0,s.S1)(e,C))}));var I=this.getValueAsArray();if(I[d]=m?e.flat:(0,a.Cl)({},e),m&&p&&(I=I.join(h||",")),"input-kv"===g){var A=!1,V={};try{for(var x=(0,a.Ju)(I),N=x.next();!N.done;N=x.next())V[(F=N.value).key]?A=!0:V[F.key]=!0}catch(e){r={error:e}}finally{try{N&&!N.done&&(i=x.return)&&i.call(x)}finally{if(r)throw r.error}}A||this.props.onChange(I,v,!0)}else if("input-kvs"===g){A=!1,V={};try{for(var k=(0,a.Ju)(I),E=k.next();!E.done;E=k.next()){var F;"_key"in(F=E.value)&&(V[F._key]?A=!0:V[F._key]=!0)}}catch(e){l={error:e}}finally{try{E&&!E.done&&(o=k.return)&&o.call(k)}finally{if(l)throw l.error}}A||this.props.onChange(I,v,!0)}else this.props.onChange(I,v,!0);c.forms.forEach((function(e){return(0,f._n)(e)&&e.items.forEach((function(t){return t.unique&&t.syncOptions(void 0,e.data)}))}))}},t.prototype.handleRadioChange=function(e,t){var n=t.index,r=t.name,i=t.trueValue,l=void 0===i||i,o=t.falseValue,s=void 0!==o&&o,d=this.props,u=d.onChange,m=d.submitOnChange,c=d.multiple,p=d.disabled;if(c&&!p&&r){var h=this.getValueAsArray();if(Array.isArray(h)&&!(h.length<2)&&v()(h[0]))return h=h.map((function(e,t){var i;return(0,a.Cl)((0,a.Cl)({},e),((i={})[r]=t===n?l:s,i))})),u(h,m,!0),!1}},t.prototype.handleSingleFormChange=function(e){null===this.props.value&&y()(this.defaultValue,e)||this.props.onChange((0,a.Cl)({},e),this.props.submitOnChange,!0)},t.prototype.handleSubFormValid=function(e,t){var n=t.index;this.props.store.setMemberValid(e,n)},t.prototype.handleFormInit=function(e,t){var n,r=t.index,i=this.props,l=i.syncDefaultValue,o=i.flat,d=i.joinValues,u=i.delimiter,m=i.formInited,c=i.onChange,p=i.submitOnChange,h=i.setPrinstineValue,f=i.formItem,b=i.name,v=i.syncFields;if(Array.isArray(v)&&v.forEach((function(t){(null==b?void 0:b.startsWith(t))&&(e=(0,a.Cl)({},e),(0,s.S1)(e,b))})),(null==f?void 0:f.validated)&&(null===(n=this.subForms[r])||void 0===n||n.validate(!0,!1,!1)),this.subFormDefaultValues.push({index:r,values:e,setted:!1}),!1!==l&&this.subFormDefaultValues.length===this.subForms.filter((function(e){return void 0!==e})).length){var g=this.getValueAsArray(),y=!1;this.subFormDefaultValues=this.subFormDefaultValues.map((function(e){var t=e.index,n=e.values,r=e.setted,i=o?n.flat:(0,a.Cl)({},n);return!r&&(0,s.JQ)(g[t],i)&&(g[t]=o?n.flat:(0,a.Cl)({},n),y=!0),{index:t,values:n,setted:!0}})),y&&(o&&d&&(g=g.join(u||",")),m?c(g,p,!0):h(g))}},t.prototype.handleSingleFormInit=function(e){var t=this.props,n=t.syncDefaultValue,r=t.setPrinstineValue,i=t.value,l=t.nullable;!1!==n&&!l&&(0,s.JQ)(i,e)&&r((0,a.Cl)({},e))},t.prototype.handleAction=function(e,t){var n=this.props.onAction;"delete"!==t.actionType?n&&n.apply(null,arguments):void 0!==t.index&&this.deleteItem(t.index)},t.prototype.validate=function(){var e=this,t=this.props,n=t.messages,r=t.nullable,i=t.value,l=t.translate,o=t.store,d=t.flat,u=this.getValueAsArray(),m=this.resolveVariableProps(this.props,"minLength"),c=this.resolveVariableProps(this.props,"maxLength");if(m&&(!Array.isArray(u)||u.length<m))return l(n&&n.minLengthValidateFailed||"Combo.minLength",{minLength:m});if(c&&Array.isArray(u)&&u.length>c)return l(n&&n.maxLengthValidateFailed||"Combo.maxLength",{maxLength:c});if(!r||i){if(u.length){var p=this.subForms;return Promise.all(u.map((function(t,n){return(0,a.sH)(e,void 0,void 0,(function(){var e,r,i,l,u,m,c,h,b,v,g,y;return(0,a.YH)(this,(function(C){switch(C.label){case 0:return(e=p[n])?[2,e.validate(!0,!1,!1)]:[3,1];case 1:if(!(r=p[Object.keys(p)[0]]))return[3,10];i=r.props.store,l=!1,C.label=2;case 2:C.trys.push([2,7,8,9]),u=(0,a.Ju)(i.items),m=u.next(),C.label=3;case 3:return m.done?[3,6]:(c=m.value,h=(0,f.o8)(c),b=d?t:(0,s.dnO)(t,c.name,!1),c.extraName&&!d&&(b=[(0,s.dnO)(t,c.name,!1),(0,s.dnO)(t,c.extraName,!1)]),h.changeTmpValue(b,"dataChanged"),[4,h.validate(t)]);case 4:if(l=C.sent(),(0,f.zr)(h),!1===l)return[3,6];C.label=5;case 5:return m=u.next(),[3,3];case 6:return[3,9];case 7:return v=C.sent(),g={error:v},[3,9];case 8:try{m&&!m.done&&(y=u.return)&&y.call(u)}finally{if(g)throw g.error}return[7];case 9:return o.setMemberValid(l,n),[2,l];case 10:return[2]}}))}))}))).then((function(e){if(~e.indexOf(!1))return l(n&&n.validateFailed||"validateFailed")}))}return this.subForms.length?Promise.all(this.subForms.map((function(e){return e.validate(!0,!1,!1)}))).then((function(e){if(~e.indexOf(!1))return l(n&&n.validateFailed||"validateFailed")})):void 0}},t.prototype.flush=function(){return(0,a.sH)(this,void 0,void 0,(function(){return(0,a.YH)(this,(function(e){switch(e.label){case 0:return[4,Promise.all(this.subForms.map((function(e){return e.flush()})))];case 1:return e.sent(),[2]}}))}))},t.prototype.dragTipRef=function(e){!this.dragTip&&e?this.initDragging():this.dragTip&&!e&&this.destroyDragging(),this.dragTip=e},t.prototype.initDragging=function(){var e=this,t=this.props.classPrefix,n=this.props.submitOnChange,a=(0,i.findDOMNode)(this);this.sortable=new u.Ay(a.querySelector(".".concat(t,"Combo-items")),{group:"combo-".concat(this.id),animation:150,handle:".".concat(t,"Combo-itemDrager"),ghostClass:"".concat(t,"Combo-item--dragging"),onEnd:function(t){if(t.newIndex!==t.oldIndex){var a=t.to;t.oldIndex<a.childNodes.length-1?a.insertBefore(t.item,a.childNodes[t.oldIndex>t.newIndex?t.oldIndex+1:t.oldIndex]):a.appendChild(t.item);var r=e.props.value;if(Array.isArray(r)){var i=r.concat();i.splice(t.newIndex,0,i.splice(t.oldIndex,1)[0]),e.keys.splice(t.newIndex,0,e.keys.splice(t.oldIndex,1)[0]),e.props.onChange(i,n,!0),e.props.dispatchEvent("dragEnd",(0,s.RKM)(e.props,{item:i[t.newIndex],value:i,index:t.newIndex,oldValue:r,oldIndex:t.oldIndex}))}}}})},t.prototype.destroyDragging=function(){this.sortable&&this.sortable.destroy()},Object.defineProperty(t.prototype,"subForms",{get:function(){var e=this;return Object.keys(this.refsMap).map((function(e){return parseInt(e,10)})).sort().map((function(t){return e.refsMap[t]}))},enumerable:!1,configurable:!0}),t.prototype.formRef=function(e,t){if(void 0===t&&(t=0),e){for(;e&&e.getWrappedInstance;)e=e.getWrappedInstance();this.refsMap[t]=e}else this.refsMap[t],this.subFormDefaultValues=this.subFormDefaultValues.filter((function(e){return e.index!==t})),delete this.refsMap[t]},t.prototype.formatValue=function(e,t){void 0===t&&(t=-1);var n=this.props,a=n.flat,r=n.data,i=n.strictMode,l=n.syncFields;return a&&(e={flat:e}),e=e||this.defaultValue,this.memoizedFormatValue(!1!==i,l,e,t,r)},t.prototype.pickCondition=function(e){var t=this.props.conditions;return c()(t,(function(t){return t.test&&(0,s.pgu)(t.test,e)}))},t.prototype.handleComboTypeChange=function(e,t){var n=this.props,r=n.multiple,i=n.onChange,l=n.value;n.flat;var o=n.submitOnChange,d=this.props.conditions,u=c()(d,(function(e){return e.label===t.label}));if(u)if(r){var m=this.getValueAsArray();m.splice(e,1,(0,a.Cl)({},(0,s.nd1)(u.scaffold||{},m[e]))),i(m,o,!0)}else i((0,a.Cl)({},(0,s.nd1)(u.scaffold||{},l)),o,!0)},t.prototype.handleTabSelect=function(e){return(0,a.sH)(this,void 0,void 0,(function(){var t,n,r,i,l,o,d,u,m;return(0,a.YH)(this,(function(c){switch(c.label){case 0:return t=this.props,n=t.store,r=t.data,i=t.name,l=t.value,o=t.dispatchEvent,d={key:e,item:l[e]},[4,o("tabsChange",(0,s.ed2)(r,i?(0,a.Cl)((0,a.Cl)({},d),(m={},m[i]=l,m)):d))];case 1:return(null==(u=c.sent())?void 0:u.prevented)||n.setActiveKey(e),[2]}}))}))},t.prototype.setNull=function(e){e.preventDefault(),(0,this.props.onChange)(null),this.subForms.forEach((function(e){e.clearErrors()}))},t.prototype.renderPlaceholder=function(){var e=this.props,t=e.placeholder,n=e.translate;return r.createElement("span",{className:"text-muted"},n(t||"placeholder.noData"))},t.prototype.renderTabsMode=function(){var e=this,t=this.props;t.classPrefix;var n=t.classnames,i=t.tabsStyle;t.formClassName,t.render;var l=t.disabled,o=t.store,u=t.flat;t.subFormMode,t.addButtonText;var m=t.addable,c=t.removable,p=t.typeSwitchable,h=t.itemRemovableOn,f=t.delimiter;t.canAccessSuperData,t.addIcon;var b=t.deleteIcon,v=t.tabsLabelTpl,g=t.conditions;t.changeImmediately;var y=t.addBtnText;t.static;var C=t.translate,I=t.testIdBuilder,A=this.props.items,V=this.props.value;u&&"string"==typeof V&&(V=V.split(f||","));var x=!1!==o.removable&&!l&&!1!==c;return Array.isArray(V)||(V=[]),r.createElement(d.tU,{addBtnText:C(y||"add"),className:"ComboTabs",mode:i,activeKey:o.activeKey,onSelect:this.handleTabSelect,testIdBuilder:I,additionBtns:!l&&!1!==m&&o.addable?r.createElement("li",{className:n("Tabs-link ComboTabs-addLink")},this.renderAddBtn()):null},V.map((function(t,i){var l=e.formatValue(t,i),m=null==I?void 0:I.getChild("tab-".concat(i)),c=null,f=void 0;!x||h&&!1===(0,s.pgu)(h,t)||(f=r.createElement("div",(0,a.Cl)({onClick:e.deleteItem.bind(e,i),key:"delete",className:n("Combo-tab-delBtn ".concat(o.removable?"":"is-disabled")),"data-tooltip":C("delete"),"data-position":"bottom"},null==m?void 0:m.getChild("delBtn").getTestId()),b?r.createElement("i",{className:b}):r.createElement(d.In,{icon:"status-close",className:"icon"}))),Array.isArray(g)&&g.length&&(c=e.pickCondition(l),A=c?c.items:void 0);var y=u&&A?[(0,a.Cl)((0,a.Cl)({},A&&A[0]),{name:"flat"})]:A,V=Array.isArray(y)&&y.some((function(e){return e.unique}));return e.keys[i]||e.keys.splice(i,0,(0,s.OsD)()),r.createElement(d.oz,{title:(0,s.pbD)(v||C("{{index}}",{index:l.index+1}),l),key:e.keys[i],toolbar:f,eventKey:i,mountOnEnter:!V,unmountOnExit:!1,className:!1===o.memberValidMap[i]?"has-error":"",tabClassName:!1===o.memberValidMap[i]?"has-error":"",testIdBuilder:m},c&&!1!==p?r.createElement("div",{className:n("Combo-itemTag")},r.createElement("label",null,C("Combo.type")),r.createElement(d.l6,{onChange:e.handleComboTypeChange.bind(e,i),options:g.map((function(e){return{label:e.label,value:e.label}})),value:c.label,clearable:!1})):null,r.createElement("div",{className:n("Combo-itemInner")},y?e.renderItems(y,l,i,t):r.createElement(d.pM,{level:"warning",className:"m-b-none"},C("Combo.invalidData"))))})))},t.prototype.renderDelBtn=function(e,t){var n=this;if(this.props.static)return null;var i=this.props;i.classPrefix;var l=i.classnames,o=i.render,u=i.store,m=i.deleteIcon,c=i.translate,p=i.itemRemovableOn,h=i.disabled,f=i.removable,b=i.deleteBtn,v=i.mobileUI,g=i.data,y=i.testIdBuilder,C=null==y?void 0:y.getChild("delete-btn-".concat(t));return!1===u.removable||h||!1===f||p&&!1===(0,s.pgu)(p,e)?null:(0,s.Gvm)(b)?o("delete-btn",(0,a.Cl)((0,a.Cl)({},b),{type:"button",className:l("Combo-delController",b?b.className:""),testIdBuilder:C,onClick:function(e){if(b.onClick){var a=b.onClick;"string"==typeof a&&(a=(0,s.uPQ)(b.onClick,"e","index","props"));var r=a(e,t,n.props);r&&r.then?r.then((function(){n.deleteItem(t)})):n.deleteItem(t)}else n.deleteItem(t)}}),{data:(0,s.C5M)(g,{index:t})}):"string"==typeof b?o("delete-btn",{type:"button",className:l("Combo-delController"),label:b,onClick:this.deleteItem.bind(this,t),testIdBuilder:C}):r.createElement("a",(0,a.Cl)({onClick:this.deleteItem.bind(this,t),key:"delete",className:l("Combo-delBtn ".concat(u.removable?"":"is-disabled")),"data-tooltip":v?null:c("delete"),"data-position":"bottom"},null==C?void 0:C.getTestId()),m?r.createElement("i",{className:m}):r.createElement(d.In,{icon:"status-close",className:"icon"}))},t.prototype.renderAddBtn=function(){var e=this;if(this.props.static)return null;var t=this.props;t.classPrefix;var n=t.classnames,i=t.render,l=t.addButtonClassName,o=t.store,u=t.addButtonText,m=t.addBtn,c=t.addable,p=t.addIcon,h=t.conditions,f=t.translate,b=t.tabsMode,v=t.testIdBuilder,g=Array.isArray(h)&&h.length,y=null==v?void 0:v.getChild("add-button");return r.createElement(r.Fragment,null,o.addable&&!1!==c&&(g?i("add-button",{type:"dropdown-button",icon:p?r.createElement(d.In,{icon:"plus-fine",className:"icon"}):"",label:f(u||"add"),level:"info",size:"sm",closeOnClick:!0,btnClassName:l,testIdBuilder:y},{buttons:null==h?void 0:h.map((function(t){return{label:t.label,onClick:function(n){return e.addItemWith(t),!1}}}))}):b?r.createElement("a",{onClick:this.addItem},p?r.createElement(d.In,{icon:"plus-fine",className:"icon"}):null,r.createElement("span",null,f(u||"add"))):(0,s.Gvm)(m)?i("add-button",(0,a.Cl)((0,a.Cl)({},m),{type:"button",testIdBuilder:y,onClick:function(){return e.addItem()}})):r.createElement(d.$n,{className:n("Combo-addBtn",l),onClick:this.addItem,testIdBuilder:y},p?r.createElement(d.In,{icon:"plus-fine",className:"icon"}):null,r.createElement("span",null,f(u||"add")))))},t.prototype.renderMultipe=function(){var e=this;if(this.props.tabsMode)return this.renderTabsMode();var t=this.props;t.classPrefix;var n=t.classnames,i=t.multiLine,l=t.disabled,o=t.flat,u=t.draggable,m=t.draggableTip,c=t.typeSwitchable,p=t.delimiter,h=t.dragIcon,f=t.noBorder,b=t.conditions,v=t.placeholder,g=t.translate,y=t.itemClassName,C=t.itemsWrapperClassName,I=t.static,A=t.mobileUI,V=t.store,x=this.props.items,N=this.props.value;return o&&"string"==typeof N&&(N=N.split(p||",")),r.createElement("div",{className:n("Combo Combo--multi",{"is-mobile":A},i?"Combo--ver":"Combo--hor",f?"Combo--noBorder":"",l?"is-disabled":"",!I&&!l&&u&&Array.isArray(N)&&N.length>1?"is-draggable":"")},r.createElement("div",{className:n("Combo-items",C)},Array.isArray(N)&&N.length?N.map((function(t,i,m){var p=e.renderDelBtn(t,i),f=e.formatValue(t,i),v=null;Array.isArray(b)&&b.length&&(v=e.pickCondition(f),x=v?v.items:void 0);var C=o&&x?[(0,a.Cl)((0,a.Cl)({},x&&x[0]),{name:"flat"})]:x;return e.keys[i]||e.keys.splice(i,1,(0,s.OsD)()),r.createElement("div",{className:n("Combo-item",y,!1===V.memberValidMap[i]?"has-error":""),key:e.keys[i]},!I&&!l&&u&&m.length>1?r.createElement("div",{className:n("Combo-itemDrager")},r.createElement("a",{key:"drag","data-tooltip":g("Combo.dragDropSort"),"data-position":"bottom"},h?r.createElement("i",{className:h}):r.createElement(d.In,{icon:"drag-bar",className:"icon"}))):null,v&&!1!==c?r.createElement("div",{className:n("Combo-itemTag")},r.createElement("label",null,g("Combo.type")),r.createElement(d.l6,{onChange:e.handleComboTypeChange.bind(e,i),options:b.map((function(e){return{label:e.label,value:e.label}})),value:v.label,clearable:!1})):null,r.createElement("div",{className:n("Combo-itemInner")},C?e.renderItems(C,f,i,t):r.createElement(d.pM,{level:"warning",className:"m-b-none"},g("Combo.invalidData"))),p)})):v?r.createElement("div",{className:n("Combo-placeholder")},g(v)):null),I||l?null:r.createElement("div",{className:n("Combo-toolbar")},this.renderAddBtn(),u?r.createElement("span",{className:n("Combo-dragableTip"),ref:this.dragTipRef},Array.isArray(N)&&N.length>1?g(m):""):null))},t.prototype.renderSingle=function(){var e=this.props,t=e.conditions,n=e.classnames,a=e.value,i=e.multiLine,l=e.noBorder,o=e.disabled,u=e.typeSwitchable,m=e.nullable,c=e.translate,p=e.itemClassName,h=e.mobileUI,f=e.store,b=this.props.items,v=(0,s.Gvm)(a)?this.formatValue(a):this.formatValue(this.defaultValue),g=null;return Array.isArray(t)&&t.length&&(b=(g=this.pickCondition(v))?g.items:void 0),r.createElement("div",{className:n("Combo Combo--single",{"is-mobile":h},i?"Combo--ver":"Combo--hor",l?"Combo--noBorder":"",o?"is-disabled":"")},r.createElement("div",{className:n("Combo-item",p,!1===f.memberValidMap[0]?"has-error":"")},g&&!1!==u?r.createElement("div",{className:n("Combo-itemTag")},r.createElement("label",null,c("Combo.type")),r.createElement(d.l6,{onChange:this.handleComboTypeChange.bind(this,0),options:t.map((function(e){return{label:e.label,value:e.label}})),value:g.label,clearable:!1})):null,r.createElement("div",{className:n("Combo-itemInner")},b?this.renderItems(b,v):r.createElement(d.pM,{level:"warning",className:"m-b-none"},c("Combo.invalidData")))),a&&m?r.createElement("a",{className:n("Combo-setNullBtn"),href:"#",onClick:this.setNull},c("clear")):null)},t.prototype.renderItems=function(e,t,n,i){var l=this.props,o=l.classnames,s=l.formClassName,d=l.render,u=l.multiLine,m=l.disabled,c=l.canAccessSuperData,p=l.multiple,h=l.tabsMode,f=l.subFormMode,b=l.subFormHorizontal,v=l.changeImmediately,g=l.lazyLoad;l.translate;var y=l.static,C=l.testIdBuilder,I=l.updatePristineAfterStoreDataReInit,A=Array.isArray(e)?e.map((function(e,t){var r=void 0!==n&&n>=0?"-".concat(n):"",i="item-".concat(e.testid||e.id||t)+r;return(0,a.Cl)((0,a.Cl)({},e),{testIdBuilder:null==C?void 0:C.getChild(i)})})):e;return p?p&&void 0!==n&&n>=0?d("multiple/".concat(n),{type:"form",body:A,wrapperComponent:"div",wrapWithPanel:!1,mode:h||u?f:"row",horizontal:b,className:o("Combo-form",s)},(0,a.Cl)((0,a.Cl)({index:n,disabled:m,static:y,data:t,originData:i,onChange:this.handleChange,onInit:this.handleFormInit,onAction:this.handleAction,onRadioChange:this.handleRadioChange,ref:this.makeFormRef(n),onValidChange:this.handleSubFormValid,canAccessSuperData:c,lazyChange:!v,formLazyChange:!1,value:void 0,formItemValue:void 0,formStore:void 0},h?{}:{lazyLoad:g}),{updatePristineAfterStoreDataReInit:null!=I&&I})):r.createElement(r.Fragment,null):d("single",{type:"form",body:A,wrapperComponent:"div",wrapWithPanel:!1,mode:u?f||"normal":"row",horizontal:b,className:o("Combo-form",s)},{index:0,disabled:m,static:y,data:t,originData:i,onChange:this.handleSingleFormChange,ref:this.makeFormRef(0),onValidChange:this.handleSubFormValid,onInit:this.handleSingleFormInit,canAccessSuperData:c,lazyChange:!v,formLazyChange:!1,value:void 0,formItemValue:void 0,formStore:void 0,updatePristineAfterStoreDataReInit:null!=I&&I})},t.prototype.renderStatic=function(e){return this.props.render("static-input-kv",{type:"json"},this.props)},t.prototype.render=function(){var e=this.props,t=e.type,n=e.formInited,a=e.multiple,i=e.className;e.style,e.classPrefix;var l=e.classnames,o=e.static,s=e.staticSchema;return o&&(s||["input-kv","input-kvs"].includes(t))?this.renderStatic():n||void 0===n?r.createElement("div",{className:l("ComboControl",i)},a?this.renderMultipe():this.renderSingle()):null},t.defaultProps={minLength:0,maxLength:1/0,multiple:!1,multiLine:!1,addButtonClassName:"",formClassName:"",subFormMode:"normal",draggableTip:"",addButtonText:"add",canAccessSuperData:!1,addIcon:!0,dragIcon:"",deleteIcon:"",tabsMode:!1,tabsStyle:"",placeholder:"placeholder.empty",itemClassName:"",itemsWrapperClassName:""},t.propsList=["minLength","maxLength","multiple","multiLine","addButtonClassName","subFormMode","draggableTip","addButtonText","draggable","scaffold","canAccessSuperData","addIcon","dragIcon","deleteIcon","noBorder","conditions","tabsMode","tabsStyle","lazyLoad","changeImmediately","strictMode","items","conditions","messages","formStore","itemClassName","itemsWrapperClassName"],(0,a.Cg)([s.d6t,(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[Number]),(0,a.Sn)("design:returntype",Promise)],t.prototype,"handleTabSelect",null),(0,a.Cg)([s.d6t,(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[Object]),(0,a.Sn)("design:returntype",void 0)],t.prototype,"setNull",null),t}(r.Component),A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.C6)(t,e),t.prototype.setData=function(e,t,n,r){return(0,a.sH)(this,void 0,void 0,(function(){var t,i,l,o,d,u,m,c;return(0,a.YH)(this,(function(p){switch(p.label){case 0:return t=this.props,i=t.multiple,l=t.onChange,o=t.submitOnChange,i?(d=(0,a.fX)([],(0,a.zs)(this.getValueAsArray()),!1),u=d.length,void 0===n?[3,1]:(String(n).split(",").forEach((function(t){var n=Number(t);d.splice(n,1,(0,a.Cl)((0,a.Cl)({},d[n]),e))})),null==l||l(d,o,!0),[3,7])):[3,8];case 1:if(void 0===r)return[3,6];m=0,p.label=2;case 2:return m<u?(c=d[m],[4,(0,s.JnN)(r,c)]):[3,5];case 3:p.sent()&&d.splice(m,1,(0,a.Cl)((0,a.Cl)({},d[m]),e)),p.label=4;case 4:return m++,[3,2];case 5:return null==l||l(d,o,!0),[3,7];case 6:null==l||l(e,o,!0),p.label=7;case 7:return[3,9];case 8:null==l||l(e,o,!0),p.label=9;case 9:return[2]}}))}))},(0,a.Cg)([(0,s.eIh)({type:"combo",storeType:s.EaJ.name,extendsData:!1,shouldComponentUpdate:function(e,t){return(0,s.joH)(e.maxLength)&&(0,s.GvO)(t.maxLength,t.data)!==(0,s.GvO)(e.maxLength,e.data)||(0,s.joH)(e.minLength)&&(0,s.GvO)(t.minLength,t.data)!==(0,s.GvO)(e.minLength,e.data)}})],t)}(I),V=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.C6)(t,e),(0,a.Cg)([(0,s.eIh)({type:"input-kv",storeType:s.EaJ.name,extendsData:!1})],t)}(I),x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.C6)(t,e),(0,a.Cg)([(0,s.eIh)({type:"input-kvs",storeType:s.EaJ.name,extendsData:!1})],t)}(I)}}]);