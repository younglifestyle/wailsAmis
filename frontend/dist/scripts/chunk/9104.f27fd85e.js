"use strict";(self.webpackChunktestAmis=self.webpackChunktestAmis||[]).push([[9104],{79104:function(e,t,n){n.r(t),n.d(t,{EmailControlRenderer:function(){return f},TextControlRenderer:function(){return C},UrlControlRenderer:function(){return g},default:function(){return m},mapItemIndex:function(){return v}});var a=n(31635),i=n(96540),s=n(27648),l=n(51545),o=n(38221),r=n.n(o),u=n(7309),p=n.n(u),c=n(8096),d=n(65408),h=n(66283),m=function(e){function t(t){var n=e.call(this,t)||this,a=t.value;return n.state={isOpen:!1,inputValue:t.multiple||!1===t.creatable?"":n.valueToString(a),isFocused:!1,revealPassword:!1},n.focus=n.focus.bind(n),n.clearValue=n.clearValue.bind(n),n.toggleRevealPassword=n.toggleRevealPassword.bind(n),n.inputRef=n.inputRef.bind(n),n.handleClick=n.handleClick.bind(n),n.handleFocus=n.handleFocus.bind(n),n.handleBlur=n.handleBlur.bind(n),n.handleInputChange=n.handleInputChange.bind(n),n.handleKeyDown=n.handleKeyDown.bind(n),n.handleChange=n.handleChange.bind(n),n.handleStateChange=n.handleStateChange.bind(n),n.loadAutoComplete=r()(n.loadAutoComplete.bind(n),250,{trailing:!0,leading:!1}),n}return(0,a.C6)(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.props,n=t.formItem,i=t.autoComplete,s=t.addHook,l=t.formInited,o=t.data,r=t.name;(0,c.Amo)(i,o)&&n&&(l?n.loadOptions(i,(0,c.ed2)(o,{term:""})):s&&(this.unHook=s((function(t){return(0,a.sH)(e,void 0,void 0,(function(){return(0,a.YH)(this,(function(e){switch(e.label){case 0:return[4,n.loadOptions(i,(0,c.ed2)(t,{term:""}))];case 1:return e.sent(),n.value&&(0,c.BBb)(t,r,n.value),[2]}}))}))}),"init")))},t.prototype.componentDidUpdate=function(e){var t=this.props;e.value!==t.value&&this.setState({inputValue:t.multiple||!1===t.creatable?"":this.valueToString(t.value)}),e.revealPassword!==t.revealPassword&&!t.revealPassword&&this.setState({revealPassword:!1})},t.prototype.componentWillUnmount=function(){this.unHook&&this.unHook()},t.prototype.inputRef=function(e){this.input=e},t.prototype.doAction=function(e,t,n,a){var i=null==e?void 0:e.actionType;"reset"===i?this.resetValue():"clear"===i?this.clearValue():"focus"===i&&this.focus()},t.prototype.focus=function(){if(this.input){this.input.focus();var e=this.input.value.length;e&&("email"===this.input.type?(this.input.type="text",this.input.setSelectionRange(e,e),this.input.type="email"):this.input.setSelectionRange(e,e))}},t.prototype.resetValue=function(){var e,t;return(0,a.sH)(this,void 0,void 0,(function(){var n,i,s,l,o,r,u,p,d,h=this;return(0,a.YH)(this,(function(a){switch(a.label){case 0:return n=this.props,i=n.onChange,s=n.dispatchEvent,l=n.resetValue,o=n.formStore,r=n.store,u=n.name,p=null!==(t=(0,c.dnO)(null!==(e=null==o?void 0:o.pristine)&&void 0!==e?e:null==r?void 0:r.pristine,u))&&void 0!==t?t:l,[4,s("change",(0,c.RKM)(this.props,{value:p}))];case 1:return(null==(d=a.sent())?void 0:d.prevented)||(i(p),this.setState({inputValue:p},(function(){h.focus(),h.loadAutoComplete()}))),[2]}}))}))},t.prototype.clearValue=function(){return(0,a.sH)(this,void 0,void 0,(function(){var e,t,n,i,s,l,o,r=this;return(0,a.YH)(this,(function(a){switch(a.label){case 0:return e=this.props,t=e.onChange,n=e.dispatchEvent,i=e.clearValueOnEmpty,s=this.props.resetValue,i&&""===s&&(s=void 0),[4,n("clear",(0,c.RKM)(this.props,{value:s}))];case 1:return(null==(l=a.sent())?void 0:l.prevented)?[2]:[4,n("change",(0,c.RKM)(this.props,{value:s}))];case 2:return(null==(o=a.sent())?void 0:o.prevented)||(t(s),this.setState({inputValue:s},(function(){r.focus(),r.loadAutoComplete()}))),[2]}}))}))},t.prototype.removeItem=function(e){var t=this.props,n=t.selectedOptions,a=t.onChange,i=n.concat();i.splice(e,1),a(this.normalizeValue(i))},t.prototype.handleClick=function(){return(0,a.sH)(this,void 0,void 0,(function(){var e,t,n,i;return(0,a.YH)(this,(function(a){switch(a.label){case 0:return e=this.props,t=e.dispatchEvent,n=e.value,[4,t("click",(0,c.RKM)(this.props,{value:n}))];case 1:return(null==(i=a.sent())?void 0:i.prevented)||(this.state.isFocused||this.focus(),this.setState({isOpen:!0})),[2]}}))}))},t.prototype.handleFocus=function(e){return(0,a.sH)(this,void 0,void 0,(function(){var t,n,i,s,l;return(0,a.YH)(this,(function(a){switch(a.label){case 0:return t=this.props,n=t.dispatchEvent,i=t.onFocus,s=t.value,this.setState({isOpen:!0,isFocused:!0}),[4,n("focus",(0,c.RKM)(this.props,{value:s}))];case 1:return(null==(l=a.sent())?void 0:l.prevented)||null==i||i(e),[2]}}))}))},t.prototype.handleBlur=function(e){return(0,a.sH)(this,void 0,void 0,(function(){var t,n,i,s,l,o,r,u=this;return(0,a.YH)(this,(function(a){switch(a.label){case 0:return t=this.props,n=t.onBlur,i=t.trimContents,s=t.value,l=t.onChange,o=t.dispatchEvent,this.setState({isFocused:!1},(function(){if(i&&s&&"string"==typeof s){var e=s.trim();u.input&&(u.input.value=e),l(e)}})),[4,o("blur",(0,c.RKM)(this.props,{value:s}))];case 1:return(null==(r=a.sent())?void 0:r.prevented)||n&&n(e),[2]}}))}))},t.prototype.close=function(){this.setState({isFocused:!1})},t.prototype.handleInputChange=function(e){return(0,a.sH)(this,void 0,void 0,(function(){var t,n,i,s,l,o,r=this;return(0,a.YH)(this,(function(a){switch(a.label){case 0:return t=this.transformValue(e.currentTarget.value),n=this.props,i=n.creatable,s=n.multiple,l=n.onChange,[4,(0,n.dispatchEvent)("change",(0,c.RKM)(this.props,{value:t}))];case 1:return(null==(o=a.sent())?void 0:o.prevented)||this.setState({inputValue:t},(function(){!1===i||s||null==l||l(t),r.loadAutoComplete()})),[2]}}))}))},t.prototype.handleKeyDown=function(e){var t;return(0,a.sH)(this,void 0,void 0,(function(){var n,i,s,l,o,r,u,d,h,m;return(0,a.YH)(this,(function(a){switch(a.label){case 0:return n=this.props,i=n.selectedOptions,s=n.onChange,l=n.multiple,o=n.creatable,r=n.dispatchEvent,u=(null===(t=this.props)||void 0===t?void 0:t.valueField)||"value",!i.length||this.state.inputValue||8!==e.keyCode?[3,1]:(e.preventDefault(),(h=i.concat()).pop(),s(this.normalizeValue(h)),this.setState({inputValue:""},this.loadAutoComplete),[3,4]);case 1:return"Enter"===e.key&&this.state.inputValue&&"number"!=typeof this.highlightedIndex&&!1!==o?(e.preventDefault(),d=this.state.inputValue,l&&d&&(p()(i,(function(e){return e[u]==d}))?d=this.normalizeValue(i).concat():((h=i.concat()).push({label:d,value:d}),d=this.normalizeValue(h).concat())),[4,r("enter",(0,c.RKM)(this.props,{value:d}))]):[3,3];case 2:return(null==(m=a.sent())?void 0:m.prevented)?[2]:(s(d),this.setState({inputValue:l?"":d,isOpen:!1},this.loadAutoComplete),[3,4]);case 3:"Enter"===e.key&&this.state.isOpen&&"number"!=typeof this.highlightedIndex&&this.setState({isOpen:!1}),a.label=4;case 4:return[2]}}))}))},t.prototype.handleChange=function(e){var t=this.props,n=t.onChange,a=t.multiple,i=t.options,s=t.selectedOptions,l=t.creatable,o=t.valueField,r=i.find((function(t){return t[o||"value"]===e}));if(a){var u=s.concat();r&&u.push(r),n(this.normalizeValue(u))}else n(r?this.normalizeValue(r):e);(a||!1===l)&&this.setState({inputValue:""},this.loadAutoComplete)},t.prototype.handleStateChange=function(e){var t=this.props.creatable,n=this.props.multiple||this.props.multi;switch(e.type){case s.Ay.stateChangeTypes.itemMouseEnter:case s.Ay.stateChangeTypes.changeInput:this.setState({isOpen:!0});break;default:var a={};void 0!==e.isOpen&&(a.isOpen=e.isOpen),void 0!==e.highlightedIndex&&(this.highlightedIndex=e.highlightedIndex),!n&&!1===t&&this.state.isOpen&&!1===e.isOpen&&(a.inputValue=""),this.setState(a)}},t.prototype.handleNormalInputChange=function(e){return(0,a.sH)(this,void 0,void 0,(function(){var t,n,i,s,l,o,r;return(0,a.YH)(this,(function(a){switch(a.label){case 0:return t=this.props,n=t.onChange,i=t.dispatchEvent,s=t.trimContents,l=t.clearValueOnEmpty,"string"==typeof(o=this.transformValue(e.currentTarget.value))&&(s&&(o=o.trim()),l&&""===o&&(o=void 0)),[4,i("change",(0,c.RKM)(this.props,{value:o}))];case 1:return(null==(r=a.sent())?void 0:r.prevented)||n(o),[2]}}))}))},t.prototype.normalizeValue=function(e){var t=this.props,n=t.multiple,a=t.delimiter,i=t.joinValues,s=t.extractValue,l=t.valueField,o=Array.isArray(e)?e:e?[e]:[];if(i)return o.map((function(e){return e[l||"value"]})).join(a||",");if(s){var r=o.map((function(e){return e[l||"value"]}));return n?r:r[0]}return n?o:o[0]},t.prototype.transformValue=function(e){var t=this.props.transform;return t?(Object.keys(t).forEach((function(n){var a=t[n];switch(n){case"lowerCase":a&&(e=e.toLowerCase());break;case"upperCase":a&&(e=e.toUpperCase())}})),e):e},t.prototype.loadAutoComplete=function(){var e=this.props,t=e.formItem,n=e.autoComplete,a=e.data;(0,c.Amo)(n,a)&&t&&t.loadOptions(n,(0,c.ed2)(a,{term:this.state.inputValue||""}),{extendsOptions:!0})},t.prototype.reload=function(){var e=this.props.reloadOptions;e&&e()},t.prototype.valueToString=function(e){return null==e?"":"string"==typeof e?e:e instanceof Date?e.toISOString():JSON.stringify(e)},t.prototype.getTarget=function(){var e;return null===(e=this.input)||void 0===e?void 0:e.parentElement},t.prototype.renderSugestMode=function(){var e,t=this,n=this.props,o=n.className;n.style;var r=n.inputControlClassName,u=n.nativeInputClassName,p=n.inputOnly,h=n.value,m=n.placeholder,C=n.classnames,f=n.disabled,g=n.readOnly,y=n.name,b=n.loading,x=n.clearable,N=n.options,T=n.selectedOptions,O=n.autoComplete,E=n.labelField,w=n.valueField,I=n.multiple,S=n.creatable,V=n.borderMode,k=n.showCounter,F=n.data,H=n.maxLength,A=n.minLength,P=n.translate,R=n.loadingConfig,D=n.popOverContainer,K=n.themeCss,M=n.css,B=n.id,z=n.nativeAutoComplete,L=n.testIdBuilder,Y=null===(e=this.props.type)||void 0===e?void 0:e.replace(/^(?:native|input)\-/,"");return i.createElement(s.Ay,{isOpen:this.state.isOpen&&!f&&!g,inputValue:this.state.inputValue,onChange:this.handleChange,onStateChange:this.handleStateChange,selectedItem:T.map((function(e){return e[w||"value"]}))},(function(e){var n,s,j,U=e.getInputProps,Q=e.getItemProps,q=e.isOpen,J=e.inputValue,W=e.selectedItem,Z=e.highlightedIndex,$=J&&q&&!O?(0,l.Ht)(N,J,{keys:[E||"label",w||"value"],threshold:l.Ht.rankings.CONTAINS}):N,G=q?v($,W):{};$=$.filter((function(e){return!~W.indexOf(e.value)})),t.state.inputValue&&!1!==S&&I&&!$.some((function(e){return e.value===t.state.inputValue}))&&!~W.indexOf(t.state.inputValue)&&$.push(((n={})[E||"label"]=t.state.inputValue,n[w||"value"]=t.state.inputValue,n.isNew=!0,n));var X=(0,c.pbD)(m,F);return i.createElement("div",(0,a.Cl)({className:C("TextControl-input TextControl-input--withAC",r,(0,c.NH8)((0,a.Cl)((0,a.Cl)({},t.props),{name:"inputControlClassName",id:B,themeCss:K||M})),(0,c.NH8)((0,a.Cl)((0,a.Cl)({},t.props),{name:"inputControlClassName",id:B,themeCss:K||M,extra:"inner"})),p?o:"",(s={"is-opened":q,"TextControl-input--multiple":I},s["TextControl-input--border".concat((0,c.TF7)(V))]=V,s)),onClick:t.handleClick},null==L?void 0:L.getTestId()),i.createElement(i.Fragment,null,!X||T.length||t.state.inputValue||t.state.isFocused?null:i.createElement("div",{className:C("TextControl-placeholder")},X),T.map((function(e,n){return I?i.createElement("div",{className:C("TextControl-value"),key:n},i.createElement(d.Fo,{className:C("TextControl-valueLabel"),tooltip:"".concat(e[E||"label"])},"".concat(e[E||"label"])),i.createElement(d.In,{icon:"close",className:C("TextControl-valueIcon","icon"),onClick:t.removeItem.bind(t,n)})):J&&q||!1!==S?null:i.createElement("div",{className:C("TextControl-value"),key:n},e.label)})),i.createElement(d.pd,(0,a.Cl)({},U({name:y,ref:t.inputRef,disabled:f,readOnly:g,type:Y,onFocus:t.handleFocus,onBlur:t.handleBlur,onChange:t.handleInputChange,onKeyDown:t.handleKeyDown,maxLength:H,minLength:A}),{autoComplete:z,size:10,className:C(u)}))),x&&!f&&!g&&h?i.createElement("a",{onClick:t.clearValue,className:C("TextControl-clear")},i.createElement(d.In,{icon:"input-clear",className:"icon",iconContent:"InputText-clear"})):null,k?i.createElement("span",{className:C("TextControl-counter")},"".concat(null===(j=t.valueToString(h))||void 0===j?void 0:j.length).concat("number"==typeof H&&H?"/".concat(H):"")):null,b?i.createElement(d.y$,{show:!0,icon:"reload",size:"sm",spinnerClassName:C("TextControl-spinner"),loadingConfig:R}):null,i.createElement(c.hJs,{container:D||t.getTarget,target:t.getTarget,show:!(!q||!$.length)},i.createElement(c.Kx3,{className:C("TextControl-popover"),style:{width:t.input?t.input.parentElement.offsetWidth:"auto"}},i.createElement("div",{className:C("TextControl-sugs")},$.map((function(e){var t=e[E||"label"],n=e[w||"value"];return i.createElement("div",(0,a.Cl)({},Q({item:n,disabled:e.disabled,className:C("TextControl-sugItem",{"is-highlight":Z===G[n],"is-disabled":e.disabled||e.readOnly})}),{key:n}),e.isNew?i.createElement("span",null,P("Text.add",{label:t}),i.createElement(d.In,{icon:"enter",className:"icon"})):i.createElement("span",null,e.disabled?t:(0,c.ZtY)(t,J),e.tip))}))))))}))},t.prototype.toggleRevealPassword=function(){this.setState({revealPassword:!this.state.revealPassword})},t.prototype.renderNormal=function(){var e,t,n,s=this.props;s.classPrefix;var l=s.classnames,o=s.className;s.style;var r=s.inputControlClassName,u=s.nativeInputClassName,p=s.inputOnly,h=s.value,m=s.placeholder;s.onChange;var v=s.disabled,C=s.readOnly,f=s.max,g=s.min,y=s.step,b=s.clearable,x=s.revealPassword,N=void 0===x||x,T=s.name,O=s.borderMode,E=s.prefix,w=s.suffix,I=s.data,S=s.showCounter,V=s.maxLength,k=s.minLength,F=s.themeCss,H=s.css,A=s.id,P=s.nativeAutoComplete,R=s.testIdBuilder,D=null===(t=this.props.type)||void 0===t?void 0:t.replace(/^(?:native|input)\-/,"");return i.createElement("div",(0,a.Cl)({className:l("TextControl-input",(e={},e["TextControl-input--border".concat((0,c.TF7)(O))]=O,e),(0,c.NH8)((0,a.Cl)((0,a.Cl)({},this.props),{name:"inputControlClassName",id:A,themeCss:F||H})),(0,c.NH8)((0,a.Cl)((0,a.Cl)({},this.props),{name:"inputControlClassName",id:A,themeCss:F||H,extra:"inner"})),r,p?o:"")},null==R?void 0:R.getTestId()),E?i.createElement("span",{className:l("TextControl-inputPrefix")},(0,c.pbD)(E,I)):null,i.createElement(d.pd,(0,a.Cl)({name:T,placeholder:(0,c.pbD)(m,I),ref:this.inputRef,disabled:v,readOnly:C,type:this.state.revealPassword?"text":D,onFocus:this.handleFocus,onBlur:this.handleBlur,max:f,min:g,maxLength:V,minLength:k,autoComplete:P,size:10,step:y,onChange:this.handleNormalInputChange,value:this.valueToString(h),className:l(u,{"TextControl-input-password":"password"===D&&N})},null==R?void 0:R.getChild("input").getTestId())),b&&!v&&!C&&h?i.createElement("a",{onClick:this.clearValue,className:l("TextControl-clear")},i.createElement(d.In,{icon:"input-clear",className:"icon",iconContent:"InputText-clear"})):null,"password"===D&&N&&!v?i.createElement("a",{onClick:this.toggleRevealPassword,className:l("TextControl-revealPassword")},this.state.revealPassword?i.createElement(d.In,{icon:"view",className:l("TextControl-icon-view"),classNameProp:l("TextControl-icon-view"),iconContent:"InputText-view"}):i.createElement(d.In,{icon:"invisible",className:l("TextControl-icon-invisible"),classNameProp:l("TextControl-icon-invisible"),iconContent:"InputText-invisible"})):null,S?i.createElement("span",{className:l("TextControl-counter")},"".concat(null===(n=this.valueToString(h))||void 0===n?void 0:n.length).concat("number"==typeof V&&V?"/".concat(V):"")):null,w?i.createElement("span",{className:l("TextControl-inputSuffix")},(0,c.pbD)(w,I)):null)},t.prototype.renderBody=function(e){var t,n,s=this.props,l=s.classnames,o=s.className,r=s.style,u=s.classPrefix,p=s.addOn,h=s.render,m=s.data,v=s.disabled,C=s.readOnly,f=s.inputOnly,g=s.static,y=s.addOnClassName,b=s.themeCss,x=s.css,N=s.id,T="string"==typeof p?{label:p,type:"plain"}:p,O=i.createElement(d.In,{cx:l,icon:null==T?void 0:T.icon,className:"Icon"}),E=T&&!g?T.actionType||~["button","submit","reset","action"].indexOf(T.type)?i.createElement("div",{className:l("".concat(u,"TextControl-button"),y,(0,c.NH8)((0,a.Cl)((0,a.Cl)({},this.props),{name:"addOnClassName",id:N,themeCss:b||x,extra:"addOn"})))},h("addOn",T,{disabled:v})):i.createElement("div",{className:l("".concat(u,"TextControl-addOn"),y,(0,c.NH8)((0,a.Cl)((0,a.Cl)({},this.props),{name:"addOnClassName",id:N,themeCss:b||x,extra:"addOn"})))},O,T.label?(0,c.pbD)(T.label,m):null):null;if(f)return e;var w=g?l("".concat(u,"TextControl"),((n={})["".concat(u,"TextControl--withAddOn")]=!!E,n)):l(o,"".concat(u,"TextControl"),((t={})["".concat(u,"TextControl--withAddOn")]=!!E,t["is-focused"]=this.state.isFocused,t["is-disabled"]=v||C,t));return i.createElement("div",{className:w,style:r},T&&"left"===T.position?E:null,e,T&&"left"!==T.position?E:null)},t.prototype.render=function(){var e=this.props,t=e.options,n=e.source,s=e.autoComplete,l=e.themeCss,o=e.css,r=e.id,u=e.env,p=e.classPrefix,d=!1!==s&&(n||(null==t?void 0:t.length)||s)?this.renderSugestMode():this.renderNormal();return i.createElement(i.Fragment,null,this.renderBody(d),i.createElement(c.z4D,(0,a.Cl)({},this.props,{config:{themeCss:l||o,classNames:[{key:"inputControlClassName",weights:{focused:{parent:".".concat(p,"TextControl.is-focused")},disabled:{parent:".".concat(p,"TextControl.is-disabled")}}}],id:r},env:u})),i.createElement(c.z4D,(0,a.Cl)({},this.props,{config:{themeCss:(0,c.oKQ)(l||o),classNames:[{key:"inputControlClassName",weights:{default:{inner:"input"},hover:{inner:"input"},focused:{parent:".".concat(p,"TextControl.is-focused"),inner:"input"},disabled:{parent:".".concat(p,"TextControl.is-disabled"),inner:"input"}}}],id:r&&r+"-inner"},env:u})),i.createElement(c.z4D,(0,a.Cl)({},this.props,{config:{themeCss:l||o,classNames:[{key:"addOnClassName"}],id:r&&r+"-addOn"},env:u})))},t.defaultProps={resetValue:"",labelField:"label",valueField:"value",placeholder:"",allowInputText:!0,trimContents:!0,nativeAutoComplete:"off"},(0,a.Cg)([c.d6t,(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[]),(0,a.Sn)("design:returntype",void 0)],t.prototype,"close",null),(0,a.Cg)([c.d6t,(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[Object]),(0,a.Sn)("design:returntype",Promise)],t.prototype,"handleNormalInputChange",null),(0,a.Cg)([c.d6t,(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[]),(0,a.Sn)("design:returntype",void 0)],t.prototype,"getTarget",null),(0,a.Cg)([c.d6t,(0,h.E)(),(0,a.Sn)("design:type",Function),(0,a.Sn)("design:paramtypes",[]),(0,a.Sn)("design:returntype",Object)],t.prototype,"render",null),t}(i.PureComponent);function v(e,t,n){return void 0===n&&(n="value"),e.filter((function(e){return-1===t.indexOf(e[n||"value"])})).reduce((function(e,t,a){return e[t[n||"value"]]=a,e}),{})}var C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.C6)(t,e),(0,a.Cg)([(0,c.QqA)({type:"input-text",alias:["input-password","native-date","native-time","native-number"]})],t)}(m),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.C6)(t,e),(0,a.Cg)([(0,c.QqA)({type:"input-email",validations:"isEmail"})],t)}(m),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.C6)(t,e),(0,a.Cg)([(0,c.QqA)({type:"input-url",validations:"isUrl"})],t)}(m)}}]);